


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>Channels - æternity Documentation Hub</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.4dd2dd8d.min.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.6a5ad368.min.css">
      
      
        
        
        <meta name="theme-color" content="#e92063">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../site/assets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="pink" data-md-color-accent="white">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#channels-intended-usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../../.." title="æternity Documentation Hub" class="md-header-nav__button md-logo" aria-label="æternity Documentation Hub">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            æternity Documentation Hub
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Channels
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/aeternity/documentation-hub/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aeternity/documentation-hub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="æternity Documentation Hub" class="md-nav__button md-logo" aria-label="æternity Documentation Hub">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    æternity Documentation Hub
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aeternity/documentation-hub/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aeternity/documentation-hub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../quick_glossary/" title="Quick Glossary" class="md-nav__link">
      Quick Glossary
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Node
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Node" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Node
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Get Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Get Started" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        Get Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/build-windows/" title="Build in Windows" class="md-nav__link">
      Build in Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/build/" title="Build in Ubuntu" class="md-nav__link">
      Build in Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/cuda-miner/" title="CUDA Miner" class="md-nav__link">
      CUDA Miner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/installation-windows/" title="Installation in Windows" class="md-nav__link">
      Installation in Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/installation/" title="Installation in Ubuntu" class="md-nav__link">
      Installation in Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aeternity/docs/operation/" title="Operation" class="md-nav__link">
      Operation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Protocol
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Protocol" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Protocol
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../" title="æternity Protocol" class="md-nav__link">
      æternity Protocol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../AENS/" title="AENS Naming System" class="md-nav__link">
      AENS Naming System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../GOSSIP/" title="Gossip" class="md-nav__link">
      Gossip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../STRATUM/" title="Stratum" class="md-nav__link">
      Stratum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../SYNC/" title="Sync" class="md-nav__link">
      Sync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../serializations/" title="Serializations" class="md-nav__link">
      Serializations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      Channels
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Channels" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        <span class="md-nav__icon md-icon"></span>
        Channels
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../channels/" title="State Channels" class="md-nav__link">
      State Channels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../channels/OFF-CHAIN/" title="Off-chain" class="md-nav__link">
      Off-chain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../channels/ON-CHAIN/" title="On-chain" class="md-nav__link">
      On-chain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../channels/authentication/" title="Authentication" class="md-nav__link">
      Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../channels/state/" title="State" class="md-nav__link">
      State
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Consensus
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Consensus" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        <span class="md-nav__icon md-icon"></span>
        Consensus
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../consensus/bitcoin-ng/" title="Bitcoin-NG" class="md-nav__link">
      Bitcoin-NG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../consensus/coinbase/" title="Coinbase" class="md-nav__link">
      Coinbase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../consensus/consensus/" title="Consensus" class="md-nav__link">
      Consensus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../consensus/inflation.png" title="Inflation" class="md-nav__link">
      Inflation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../consensus/locking/" title="Locking" class="md-nav__link">
      Locking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Contracts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Contracts" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        <span class="md-nav__icon md-icon"></span>
        Contracts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/aevm/" title="AEVM" class="md-nav__link">
      AEVM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/contract_life_cycle/" title="Contract Life Cycle Examples" class="md-nav__link">
      Contract Life Cycle Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/contract_state_tree/" title="Contract State Tree" class="md-nav__link">
      Contract State Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/contract_transactions/" title="Contract Transactions" class="md-nav__link">
      Contract Transactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/contract_vms/" title="Contract VMS" class="md-nav__link">
      Contract VMS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/contracts/" title="Contracts" class="md-nav__link">
      Contracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/solidity/" title="The Solidity Language" class="md-nav__link">
      The Solidity Language
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/sophia/" title="The Sophia Language" class="md-nav__link">
      The Sophia Language
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/sophia_explained/" title="Sophia Explained" class="md-nav__link">
      Sophia Explained
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/sophia_stdlib/" title="Standard Library" class="md-nav__link">
      Standard Library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../contracts/varna/" title="The Varna Language" class="md-nav__link">
      The Varna Language
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Generalized Accounts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Generalized Accounts" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        <span class="md-nav__icon md-icon"></span>
        Generalized Accounts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../generalized_accounts/ga_explained/" title="Generalized Accounts" class="md-nav__link">
      Generalized Accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../generalized_accounts/generalized_accounts/" title="Generic Accounts" class="md-nav__link">
      Generic Accounts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Node
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Node" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        <span class="md-nav__icon md-icon"></span>
        Node
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1" type="checkbox" id="nav-4-11-1">
    
    <label class="md-nav__link" for="nav-4-11-1">
      API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API" data-md-level="3">
      <label class="md-nav__title" for="nav-4-11-1">
        <span class="md-nav__icon md-icon"></span>
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../account_api_usage/" title="Account API Usage" class="md-nav__link">
      Account API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_encoding/" title="API Encoding" class="md-nav__link">
      API Encoding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../channel_ws_api/" title="State Channel WebSocket API" class="md-nav__link">
      State Channel WebSocket API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="./" title="Channels API Usage" class="md-nav__link">
      Channels API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../contract_api_usage/" title="Contract API Usage" class="md-nav__link">
      Contract API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mining_api_usage/" title="Mining API Usage" class="md-nav__link">
      Mining API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../naming_system_api_usage/" title="Naming System API Usage" class="md-nav__link">
      Naming System API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oracle_api_usage/" title="Oracle API Usage" class="md-nav__link">
      Oracle API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spend_api_usage/" title="Spend API Usage" class="md-nav__link">
      Spend API Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10" type="checkbox" id="nav-4-11-1-10">
    
    <label class="md-nav__link" for="nav-4-11-1-10">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="4">
      <label class="md-nav__title" for="nav-4-11-1-10">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1" type="checkbox" id="nav-4-11-1-10-1">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1">
      State Channels
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="State Channels" data-md-level="5">
      <label class="md-nav__title" for="nav-4-11-1-10-1">
        <span class="md-nav__icon md-icon"></span>
        State Channels
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/" title="WebSocket API Examples" class="md-nav__link">
      WebSocket API Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2" type="checkbox" id="nav-4-11-1-10-1-2">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2">
      JSON-RPS
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="JSON-RPS" data-md-level="6">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2">
        <span class="md-nav__icon md-icon"></span>
        JSON-RPS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-1" type="checkbox" id="nav-4-11-1-10-1-2-1">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-1">
      Abort Updates
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Abort Updates" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-1">
        <span class="md-nav__icon md-icon"></span>
        Abort Updates
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_deposit/" title="abort_deposit" class="md-nav__link">
      abort_deposit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_offchain_update/" title="abort_offchain_update" class="md-nav__link">
      abort_offchain_update
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_settle/" title="abort_settle" class="md-nav__link">
      abort_settle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_shutdown/" title="abort_shutdown" class="md-nav__link">
      abort_shutdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_slash/" title="abort_slash" class="md-nav__link">
      abort_slash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_snapshot_solo/" title="abort_snapshot_solo" class="md-nav__link">
      abort_snapshot_solo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_abort_withdraw/" title="abort_withdraw" class="md-nav__link">
      abort_withdraw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/abort_updates/sc_ws_can_not_abort_while_open/" title="can_not_abort_while_open" class="md-nav__link">
      can_not_abort_while_open
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-2" type="checkbox" id="nav-4-11-1-10-1-2-2">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-2">
      Changeable Fee
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Changeable Fee" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-2">
        <span class="md-nav__icon md-icon"></span>
        Changeable Fee
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_close_mutual/" title="set_fee_close_mutual" class="md-nav__link">
      set_fee_close_mutual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_close_solo/" title="set_fee_close_solo" class="md-nav__link">
      set_fee_close_solo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_create/" title="set_fee_create" class="md-nav__link">
      set_fee_create
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_deposit/" title="set_fee_deposit" class="md-nav__link">
      set_fee_deposit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_settle/" title="set_fee_settle" class="md-nav__link">
      set_fee_settle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_slash/" title="set_fee_slash" class="md-nav__link">
      set_fee_slash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_snapshot/" title="set_fee_snapshot" class="md-nav__link">
      set_fee_snapshot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_withdrawl.md" title="set_fee_withdrawl" class="md-nav__link">
      set_fee_withdrawl
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-3" type="checkbox" id="nav-4-11-1-10-1-2-3">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-3">
      Continious
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Continious" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-3">
        <span class="md-nav__icon md-icon"></span>
        Continious
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/init_per_group/" title="init_per_group" class="md-nav__link">
      init_per_group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/sc_ws_deposit/" title="deposit" class="md-nav__link">
      deposit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/sc_ws_failed_update/" title="failed_update" class="md-nav__link">
      failed_update
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/sc_ws_generic_messages/" title="generic_messages" class="md-nav__link">
      generic_messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/sc_ws_ping_pong/" title="ping_pong" class="md-nav__link">
      ping_pong
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/sc_ws_update_conflict/" title="update_conflict" class="md-nav__link">
      update_conflict
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/continuous/sc_ws_withdraw/" title="withdraw" class="md-nav__link">
      withdraw
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-4" type="checkbox" id="nav-4-11-1-10-1-2-4">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-4">
      Contracts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Contracts" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-4">
        <span class="md-nav__icon md-icon"></span>
        Contracts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/init_per_group/" title="init_per_group" class="md-nav__link">
      init_per_group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/sc_ws_environment_contract/" title="environment_contract" class="md-nav__link">
      environment_contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/sc_ws_nameservice_contract/" title="nameservice_contract" class="md-nav__link">
      nameservice_contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/sc_ws_oracle_contract/" title="oracle_contract" class="md-nav__link">
      oracle_contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/sc_ws_remote_call_contract/" title="remote_call_contract" class="md-nav__link">
      remote_call_contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/sc_ws_remote_call_contract_refering_onchain_data/" title="remote_call_contract_refering_onchain_data" class="md-nav__link">
      remote_call_contract_refering_onchain_data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/contracts/sc_ws_wrong_call_data/" title="wrong_call_data" class="md-nav__link">
      wrong_call_data
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-5" type="checkbox" id="nav-4-11-1-10-1-2-5">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-5">
      Generalized Accounts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Generalized Accounts" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-5">
        <span class="md-nav__icon md-icon"></span>
        Generalized Accounts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-5-1" type="checkbox" id="nav-4-11-1-10-1-2-5-1">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-5-1">
      both
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="both" data-md-level="8">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-5-1">
        <span class="md-nav__icon md-icon"></span>
        both
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/generalized_accounts/both/basic_open_close.md" title="basic_open_close" class="md-nav__link">
      basic_open_close
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-5-2" type="checkbox" id="nav-4-11-1-10-1-2-5-2">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-5-2">
      initiator
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="initiator" data-md-level="8">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-5-2">
        <span class="md-nav__icon md-icon"></span>
        initiator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/generalized_accounts/initiator/basic_open_close.md" title="basic_open_close" class="md-nav__link">
      basic_open_close
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-5-3" type="checkbox" id="nav-4-11-1-10-1-2-5-3">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-5-3">
      responder
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="responder" data-md-level="8">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-5-3">
        <span class="md-nav__icon md-icon"></span>
        responder
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/generalized_accounts/responder/basic_open_close.md" title="basic_open_close" class="md-nav__link">
      basic_open_close
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-6" type="checkbox" id="nav-4-11-1-10-1-2-6">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-6">
      Reconnect
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reconnect" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-6">
        <span class="md-nav__icon md-icon"></span>
        Reconnect
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/reconnect/basic_client_reconnect_i.md" title="basic_client_reconnect_i" class="md-nav__link">
      basic_client_reconnect_i
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/reconnect/basic_client_reconnect_i_w_reestablish.md" title="basic_client_reconnect_i_w_reestablish" class="md-nav__link">
      basic_client_reconnect_i_w_reestablish
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/reconnect/basic_client_reconnect_r.md" title="basic_client_reconnect_r" class="md-nav__link">
      basic_client_reconnect_r
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11-1-10-1-2-7" type="checkbox" id="nav-4-11-1-10-1-2-7">
    
    <label class="md-nav__link" for="nav-4-11-1-10-1-2-7">
      With Meta
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="With Meta" data-md-level="7">
      <label class="md-nav__title" for="nav-4-11-1-10-1-2-7">
        <span class="md-nav__icon md-icon"></span>
        With Meta
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/with_meta/init_per_group/" title="init_per_group" class="md-nav__link">
      init_per_group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/with_meta/sc_ws_deposit/" title="deposit" class="md-nav__link">
      deposit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/with_meta/sc_ws_remote_call_contract/" title="remote_call_contract" class="md-nav__link">
      remote_call_contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/with_meta/sc_ws_withdraw/" title="withdraw" class="md-nav__link">
      withdraw
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_basic_open_close_server/" title="basic_open_close" class="md-nav__link">
      basic_open_close
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_basic_open_close/" title="basic_open_close_server" class="md-nav__link">
      basic_open_close_server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_broken_open_params/" title="broken_open_params" class="md-nav__link">
      broken_open_params
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_set_fee_close_mutual.md" title="close_mutual" class="md-nav__link">
      close_mutual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_close_mutual/" title="close_solo" class="md-nav__link">
      close_solo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_leave_reconnect/" title="leave_reconnect" class="md-nav__link">
      leave_reconnect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_leave_reestablish/" title="leave_reestablish" class="md-nav__link">
      leave_reestablish
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_leave_reestablish_responder_stays/" title="leave_reestablish_responder_stays" class="md-nav__link">
      leave_reestablish_responder_stays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/sc_ws_leave_reestablish_wrong_fsm_id/" title="leave_reestablish_wrong_fsm_id" class="md-nav__link">
      leave_reestablish_wrong_fsm_id
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/min_depth_is_modifiable.md" title="min_depth_is_modifiable" class="md-nav__link">
      min_depth_is_modifiable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/min_depth_not_reached_timeout.md" title="min_depth_not_reached_timeout" class="md-nav__link">
      min_depth_not_reached_timeout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/opening_ping_pong.md" title="opening_ping_pong" class="md-nav__link">
      opening_ping_pong
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/slash.md" title="slash" class="md-nav__link">
      slash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/snapshot_solo.md" title="snapshot_solo" class="md-nav__link">
      snapshot_solo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/timeout_open.md" title="timeout_open" class="md-nav__link">
      timeout_open
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/channels/json-rpc/update_with_meta.md" title="update_with_meta" class="md-nav__link">
      update_with_meta
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Oracles
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Oracles" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        <span class="md-nav__icon md-icon"></span>
        Oracles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../oracles/oracles/" title="Oracles" class="md-nav__link">
      Oracles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../oracles/oracle_life_cycle/" title="Oracle Life Cycle Examples" class="md-nav__link">
      Oracle Life Cycle Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../oracles/oracle_state_tree/" title="Oracle State Tree" class="md-nav__link">
      Oracle State Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../oracles/oracle_transactions.md." title="Oracle Transactions" class="md-nav__link">
      Oracle Transactions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Aetmodel
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Aetmodel" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Aetmodel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aetmodel/ThreatModel/" title="Threat Model" class="md-nav__link">
      Threat Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      AEXs
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="AEXs" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        AEXs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-1/" title="AEX1" class="md-nav__link">
      AEX1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-2/" title="AEX2" class="md-nav__link">
      AEX2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-3/" title="AEX3" class="md-nav__link">
      AEX3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-4/" title="AEX4" class="md-nav__link">
      AEX4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-5/" title="AEX5" class="md-nav__link">
      AEX5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-7/" title="AEX7" class="md-nav__link">
      AEX7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-9/" title="AEX9" class="md-nav__link">
      AEX9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-10/" title="AEX10" class="md-nav__link">
      AEX10
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../AEXs/AEXS/aex-draft_data_serialization/" title="AEX-Draft" class="md-nav__link">
      AEX-Draft
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Node Usage API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Node Usage API" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Node Usage API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      Latest Stable Release
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Latest Stable Release" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        <span class="md-nav__icon md-icon"></span>
        Latest Stable Release
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api-docs/README.md" title="Autogenerated æternity Node API Documentation" class="md-nav__link">
      Autogenerated æternity Node API Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api_encoding/" title="Encoding Scheme" class="md-nav__link">
      Encoding Scheme
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../account_api_usage/" title="Account Managment" class="md-nav__link">
      Account Managment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spend_api_usage/" title="Spending Tokens" class="md-nav__link">
      Spending Tokens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oracle_api_usage/" title="Oracle" class="md-nav__link">
      Oracle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../naming_system_api_usage/" title="Naming System" class="md-nav__link">
      Naming System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../contract_api_usage/" title="Contract" class="md-nav__link">
      Contract
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Channels
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Channels" class="md-nav__link md-nav__link--active">
      Channels
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important" class="md-nav__link">
    Important
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#websocket-life-cycle" class="md-nav__link">
    WebSocket life cycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-chain-requests" class="md-nav__link">
    On-chain requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pinned-environment" class="md-nav__link">
    Pinned environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-open" class="md-nav__link">
    Channel open
  </a>
  
    <nav class="md-nav" aria-label="Channel open">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#websocket-protocol" class="md-nav__link">
    Websocket protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-parameters" class="md-nav__link">
    Channel parameters
  </a>
  
    <nav class="md-nav" aria-label="Channel parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel-establishing-parameters" class="md-nav__link">
    Channel establishing parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-timeout-values" class="md-nav__link">
    Channel timeout values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-block-hash-delta-values" class="md-nav__link">
    Channel block hash delta values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-websocket-open" class="md-nav__link">
    Responder WebSocket open
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initiator-websocket-open" class="md-nav__link">
    Initiator WebSocket open
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-opened-messages" class="md-nav__link">
    Connection opened messages
  </a>
  
    <nav class="md-nav" aria-label="Connection opened messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiator-connection-opened-message" class="md-nav__link">
    Initiator connection opened message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-connection-opened-message" class="md-nav__link">
    Responder connection opened message
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-transaction-authentication" class="md-nav__link">
    Create transaction authentication
  </a>
  
    <nav class="md-nav" aria-label="Create transaction authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiator-authenticates-the-tx" class="md-nav__link">
    Initiator authenticates the tx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-is-informed" class="md-nav__link">
    Responder is informed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-authenticates-the-tx" class="md-nav__link">
    Responder authenticates the tx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initiator-is-informed" class="md-nav__link">
    Initiator is informed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authenticated-channel_create_tx" class="md-nav__link">
    Authenticated channel_create_tx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-in-mempool" class="md-nav__link">
    Transaction in mempool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-detected-on-chain" class="md-nav__link">
    Transaction detected on-chain
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mininum-depth-confirmation" class="md-nav__link">
    Mininum-depth confirmation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-state" class="md-nav__link">
    Initial state
  </a>
  
    <nav class="md-nav" aria-label="Initial state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-confirmation" class="md-nav__link">
    Open confirmation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-changed" class="md-nav__link">
    State changed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-reconnect" class="md-nav__link">
    Client reconnect
  </a>
  
    <nav class="md-nav" aria-label="Client reconnect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-off-chain-update" class="md-nav__link">
    Channel off-chain update
  </a>
  
    <nav class="md-nav" aria-label="Channel off-chain update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel-state" class="md-nav__link">
    Channel state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta-information" class="md-nav__link">
    Meta-information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transfer" class="md-nav__link">
    Transfer
  </a>
  
    <nav class="md-nav" aria-label="Transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-transfer-update" class="md-nav__link">
    Start transfer update
  </a>
  
    <nav class="md-nav" aria-label="Start transfer update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-balances" class="md-nav__link">
    Check balances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-a-transfer-update" class="md-nav__link">
    Trigger a transfer update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starter-authenticates-updated-state" class="md-nav__link">
    Starter authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-update" class="md-nav__link">
    Finish update
  </a>
  
    <nav class="md-nav" aria-label="Finish update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-the-result-of-the-update" class="md-nav__link">
    Check the result of the update
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-contract" class="md-nav__link">
    Create a contract
  </a>
  
    <nav class="md-nav" aria-label="Create a contract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-create-contract-update" class="md-nav__link">
    Start create contract update
  </a>
  
    <nav class="md-nav" aria-label="Start create contract update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-create-contract-update" class="md-nav__link">
    Trigger a create contract update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owner-authenticates-updated-state" class="md-nav__link">
    Owner authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_1" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-update_1" class="md-nav__link">
    Finish update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contract-address-computation" class="md-nav__link">
    Contract address computation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-a-contract" class="md-nav__link">
    Call a contract
  </a>
  
    <nav class="md-nav" aria-label="Call a contract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-call-a-contract-update" class="md-nav__link">
    Start call a contract update
  </a>
  
    <nav class="md-nav" aria-label="Start call a contract update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-contract-call-update" class="md-nav__link">
    Trigger a contract call update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caller-authenticates-updated-state" class="md-nav__link">
    Caller authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_2" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-update_2" class="md-nav__link">
    Finish update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-call-result" class="md-nav__link">
    Getting a call result
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optionally-leavereestablish" class="md-nav__link">
    Optionally leave/reestablish
  </a>
  
    <nav class="md-nav" aria-label="Optionally leave/reestablish">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leave-request" class="md-nav__link">
    Leave request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reestablish" class="md-nav__link">
    Reestablish
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-mutual-close" class="md-nav__link">
    Channel mutual close
  </a>
  
    <nav class="md-nav" aria-label="Channel mutual close">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiate-mutual-close" class="md-nav__link">
    Initiate mutual close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starter-authenticating" class="md-nav__link">
    Starter authenticating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-authenticating" class="md-nav__link">
    Acknowledger authenticating
  </a>
  
    <nav class="md-nav" aria-label="Acknowledger authenticating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authenticated-channel_close_mutual_tx" class="md-nav__link">
    Authenticated channel_close_mutual_tx
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-closing" class="md-nav__link">
    Channel closing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking-the-progress-of-the-onchain-transaction" class="md-nav__link">
    Tracking the progress of the onchain transaction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-solo-close" class="md-nav__link">
    Channel solo close
  </a>
  
    <nav class="md-nav" aria-label="Channel solo close">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiate-solo-close" class="md-nav__link">
    Initiate solo close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requester-authentication" class="md-nav__link">
    Requester authentication
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-slash" class="md-nav__link">
    Channel slash
  </a>
  
    <nav class="md-nav" aria-label="Channel slash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slasher-initiates-slash" class="md-nav__link">
    Slasher initiates slash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slasher-authenticating" class="md-nav__link">
    Slasher authenticating
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-settle" class="md-nav__link">
    Channel settle
  </a>
  
    <nav class="md-nav" aria-label="Channel settle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requester-authenticating" class="md-nav__link">
    Requester authenticating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-websocket-events" class="md-nav__link">
    Other WebSocket events
  </a>
  
    <nav class="md-nav" aria-label="Other WebSocket events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-error" class="md-nav__link">
    Open error
  </a>
  
    <nav class="md-nav" aria-label="Open error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#missing-participant" class="md-nav__link">
    Missing participant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integer-value-is-too-low" class="md-nav__link">
    Integer value is too low
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-error" class="md-nav__link">
    Timeout error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-error" class="md-nav__link">
    Update error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-conflict" class="md-nav__link">
    Update conflict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abort-update" class="md-nav__link">
    Abort update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-messages" class="md-nav__link">
    Generic messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#total-balance-update-events" class="md-nav__link">
    Total balance update events
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-events" class="md-nav__link">
    Deposit events
  </a>
  
    <nav class="md-nav" aria-label="Deposit events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deposit-transaction" class="md-nav__link">
    Deposit transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-deposit" class="md-nav__link">
    Start deposit
  </a>
  
    <nav class="md-nav" aria-label="Start deposit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-deposit" class="md-nav__link">
    Trigger a deposit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#depositor-authenticates-updated-state" class="md-nav__link">
    Depositor authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_3" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-deposit" class="md-nav__link">
    Finish deposit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#withdraw-events" class="md-nav__link">
    Withdraw events
  </a>
  
    <nav class="md-nav" aria-label="Withdraw events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#withdraw-transaction" class="md-nav__link">
    Withdraw transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-withdraw" class="md-nav__link">
    Start withdraw
  </a>
  
    <nav class="md-nav" aria-label="Start withdraw">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-withdrawal" class="md-nav__link">
    Trigger a withdrawal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#withdrawer-authenticates-updated-state" class="md-nav__link">
    Withdrawer authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_4" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-withdrawal" class="md-nav__link">
    Finish withdrawal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-state" class="md-nav__link">
    Getting state
  </a>
  
    <nav class="md-nav" aria-label="Getting state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-balances" class="md-nav__link">
    Get balances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-proof-of-inclusion" class="md-nav__link">
    Get proof of inclusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dry-run-a-contract" class="md-nav__link">
    Dry-run a contract
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-contract-calls" class="md-nav__link">
    Get contract calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pruning-contract-calls" class="md-nav__link">
    Pruning contract calls
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solo-closing-sequence" class="md-nav__link">
    Solo closing sequence
  </a>
  
    <nav class="md-nav" aria-label="Solo closing sequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#payload-and-proof-of-inclusion" class="md-nav__link">
    Payload and proof of inclusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solo-close-on-chain-transaction" class="md-nav__link">
    Solo close on-chain transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slash-on-chain-transaction" class="md-nav__link">
    Slash on-chain transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settle-on-chain-transaction" class="md-nav__link">
    Settle on-chain transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-keep-alive" class="md-nav__link">
    Connection keep alive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-snapshot" class="md-nav__link">
    Channel snapshot
  </a>
  
    <nav class="md-nav" aria-label="Channel snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshotter-inittiates-a-snapshot-solo" class="md-nav__link">
    Snapshotter inittiates a snapshot solo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshotter-authenticates-the-snapshot-solo" class="md-nav__link">
    Snapshotter authenticates the snapshot solo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mining_api_usage/" title="Mining" class="md-nav__link">
      Mining
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Developer Tools
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Developer Tools" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Developer Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      æternity Framework
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="æternity Framework" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        <span class="md-nav__icon md-icon"></span>
        æternity Framework
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/%C3%A6ternity-frameworks/aepp-aeproject-js/" title="AEproject" class="md-nav__link">
      AEproject
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Software Development Kits
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Software Development Kits" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        <span class="md-nav__icon md-icon"></span>
        Software Development Kits
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1" type="checkbox" id="nav-8-2-1">
    
    <label class="md-nav__link" for="nav-8-2-1">
      JavaScript
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="JavaScript" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-1">
        <span class="md-nav__icon md-icon"></span>
        JavaScript
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/contrib/README.md" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/CHANGELOG/" title="CHANGELOG" class="md-nav__link">
      CHANGELOG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4" type="checkbox" id="nav-8-2-1-4">
    
    <label class="md-nav__link" for="nav-8-2-1-4">
      API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API" data-md-level="4">
      <label class="md-nav__title" for="nav-8-2-1-4">
        <span class="md-nav__icon md-icon"></span>
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-1" type="checkbox" id="nav-8-2-1-4-1">
    
    <label class="md-nav__link" for="nav-8-2-1-4-1">
      Account
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Account" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-1">
        <span class="md-nav__icon md-icon"></span>
        Account
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/account/memory/" title="Memory" class="md-nav__link">
      Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/account/selector/" title="Selector" class="md-nav__link">
      Selector
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-2" type="checkbox" id="nav-8-2-1-4-2">
    
    <label class="md-nav__link" for="nav-8-2-1-4-2">
      AE
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="AE" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-2">
        <span class="md-nav__icon md-icon"></span>
        AE
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/aens/" title="AENS" class="md-nav__link">
      AENS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/aepp/" title="æpp" class="md-nav__link">
      æpp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/contract/" title="Contract" class="md-nav__link">
      Contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/oracle/" title="Oracle" class="md-nav__link">
      Oracle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/universal/" title="Universal" class="md-nav__link">
      Universal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/wallet/" title="Wallet" class="md-nav__link">
      Wallet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-3" type="checkbox" id="nav-8-2-1-4-3">
    
    <label class="md-nav__link" for="nav-8-2-1-4-3">
      Chain
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Chain" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-3">
        <span class="md-nav__icon md-icon"></span>
        Chain
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/chain/node/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-4" type="checkbox" id="nav-8-2-1-4-4">
    
    <label class="md-nav__link" for="nav-8-2-1-4-4">
      Channel
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Channel" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-4">
        <span class="md-nav__icon md-icon"></span>
        Channel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/channel/" title="Channel" class="md-nav__link">
      Channel
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-5" type="checkbox" id="nav-8-2-1-4-5">
    
    <label class="md-nav__link" for="nav-8-2-1-4-5">
      Contract
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Contract" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-5">
        <span class="md-nav__icon md-icon"></span>
        Contract
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/contract/aci/" title="ACI" class="md-nav__link">
      ACI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/contract/compiler/" title="Compiler" class="md-nav__link">
      Compiler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/contract/ga/" title="Generalized Account" class="md-nav__link">
      Generalized Account
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-6" type="checkbox" id="nav-8-2-1-4-6">
    
    <label class="md-nav__link" for="nav-8-2-1-4-6">
      Oracle
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Oracle" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-6">
        <span class="md-nav__icon md-icon"></span>
        Oracle
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/oracle/node/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-7" type="checkbox" id="nav-8-2-1-4-7">
    
    <label class="md-nav__link" for="nav-8-2-1-4-7">
      RPC
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="RPC" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-7">
        <span class="md-nav__icon md-icon"></span>
        RPC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/rpc/client/" title="Client" class="md-nav__link">
      Client
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-8" type="checkbox" id="nav-8-2-1-4-8">
    
    <label class="md-nav__link" for="nav-8-2-1-4-8">
      Transcation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Transcation" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-8">
        <span class="md-nav__icon md-icon"></span>
        Transcation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-8-1" type="checkbox" id="nav-8-2-1-4-8-1">
    
    <label class="md-nav__link" for="nav-8-2-1-4-8-1">
      Helper for Builder
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Helper for Builder" data-md-level="6">
      <label class="md-nav__title" for="nav-8-2-1-4-8-1">
        <span class="md-nav__icon md-icon"></span>
        Helper for Builder
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/tx/builder/helpers/" title="Helpers" class="md-nav__link">
      Helpers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/tx/builder/schema/" title="Schema" class="md-nav__link">
      Schema
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/tx/builder/" title="Builder" class="md-nav__link">
      Builder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/tx/tx/" title="Transaction" class="md-nav__link">
      Transaction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/tx/validator/" title="Validator" class="md-nav__link">
      Validator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-9" type="checkbox" id="nav-8-2-1-4-9">
    
    <label class="md-nav__link" for="nav-8-2-1-4-9">
      Utils
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Utils" data-md-level="5">
      <label class="md-nav__title" for="nav-8-2-1-4-9">
        <span class="md-nav__icon md-icon"></span>
        Utils
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-9-1" type="checkbox" id="nav-8-2-1-4-9-1">
    
    <label class="md-nav__link" for="nav-8-2-1-4-9-1">
      Wallet Communication
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Wallet Communication" data-md-level="6">
      <label class="md-nav__title" for="nav-8-2-1-4-9-1">
        <span class="md-nav__icon md-icon"></span>
        Wallet Communication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-9-1-1" type="checkbox" id="nav-8-2-1-4-9-1-1">
    
    <label class="md-nav__link" for="nav-8-2-1-4-9-1-1">
      Connection
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Connection" data-md-level="7">
      <label class="md-nav__title" for="nav-8-2-1-4-9-1-1">
        <span class="md-nav__icon md-icon"></span>
        Connection
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/connection/browser-runtime/" title="Browser-Runtime" class="md-nav__link">
      Browser-Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/connection/browser-window-message/" title="Browser-Window-Message" class="md-nav__link">
      Browser-Window-Message
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1-4-9-1-2" type="checkbox" id="nav-8-2-1-4-9-1-2">
    
    <label class="md-nav__link" for="nav-8-2-1-4-9-1-2">
      RPC
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="RPC" data-md-level="7">
      <label class="md-nav__title" for="nav-8-2-1-4-9-1-2">
        <span class="md-nav__icon md-icon"></span>
        RPC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/rpc/aepp-rpc/" title="æpp" class="md-nav__link">
      æpp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/rpc/rpc-client/" title="Client" class="md-nav__link">
      Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/rpc/wallet-rpc/" title="Wallet" class="md-nav__link">
      Wallet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/connection/" title="Connection" class="md-nav__link">
      Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/content-script-bridge/" title="Content Script Bridge" class="md-nav__link">
      Content Script Bridge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/aepp-wallet-communication/wallet-detector/" title="Wallet Detector" class="md-nav__link">
      Wallet Detector
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/bytes/" title="Bytes" class="md-nav__link">
      Bytes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/crypto/" title="Crypto" class="md-nav__link">
      Crypto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/keystore/" title="Keystore" class="md-nav__link">
      Keystore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/utils/swagger/" title="Swagger" class="md-nav__link">
      Swagger
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/account/" title="Account" class="md-nav__link">
      Account
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/accounts/" title="Accounts" class="md-nav__link">
      Accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/ae/" title="AE" class="md-nav__link">
      AE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/chain/" title="Chain" class="md-nav__link">
      Chain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/contract/" title="Contract" class="md-nav__link">
      Contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/node-pool/" title="Node Pool" class="md-nav__link">
      Node Pool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/node/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/oracle/" title="Oracle" class="md-nav__link">
      Oracle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-js/docs/api/tx/" title="Transaction (Tx)" class="md-nav__link">
      Transaction (Tx)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-go/" title="Go" class="md-nav__link">
      Go
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-elixir/" title="Elixir" class="md-nav__link">
      Elixir
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-5" type="checkbox" id="nav-8-2-5">
    
    <label class="md-nav__link" for="nav-8-2-5">
      Java
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Java" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-5">
        <span class="md-nav__icon md-icon"></span>
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-java/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-java/CONTRIBUTING/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-java/docs/changelog/" title="CHANGELOG" class="md-nav__link">
      CHANGELOG
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/aepp-sdk-net/" title=".NET" class="md-nav__link">
      .NET
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/sdks/capability_matrix/" title="Capability Matrix" class="md-nav__link">
      Capability Matrix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/aepp-middleware/" title="Middleware" class="md-nav__link">
      Middleware
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/aepp-faucet/" title="Token Faucet" class="md-nav__link">
      Token Faucet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-5" type="checkbox" id="nav-8-5">
    
    <label class="md-nav__link" for="nav-8-5">
      Frameworks
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Frameworks" data-md-level="2">
      <label class="md-nav__title" for="nav-8-5">
        <span class="md-nav__icon md-icon"></span>
        Frameworks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/frameworks/aepp-components/" title="æpp Components" class="md-nav__link">
      æpp Components
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/aepp-contracts/" title="Contract Editor" class="md-nav__link">
      Contract Editor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-7" type="checkbox" id="nav-8-7">
    
    <label class="md-nav__link" for="nav-8-7">
      AirGap
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="AirGap" data-md-level="2">
      <label class="md-nav__title" for="nav-8-7">
        <span class="md-nav__icon md-icon"></span>
        AirGap
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/airgap/airgap-coin-lib/docs/" title="AirGap Coin Library" class="md-nav__link">
      AirGap Coin Library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/airgap/airgap-vault/" title="AirGap Vault" class="md-nav__link">
      AirGap Vault
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../developer-tools/airgap/airgap-wallet/" title="AirGap Wallet" class="md-nav__link">
      AirGap Wallet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Sophia Compiler
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sophia Compiler" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Sophia Compiler
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aesophia/" title="aesophia" class="md-nav__link">
      aesophia
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Sophia Libraries
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sophia Libraries" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        Sophia Libraries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aepp-sophia-examples/libraries/DateTime/" title="DateTime" class="md-nav__link">
      DateTime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aepp-sophia-examples/libraries/List/" title="List" class="md-nav__link">
      List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aepp-sophia-examples/libraries/Ownable/" title="Ownable" class="md-nav__link">
      Ownable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aepp-sophia-examples/libraries/FungibleToken/" title="FungibleToken" class="md-nav__link">
      FungibleToken
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aepp-sophia-examples/libraries/NonFungibleToken/" title="NonFungibleToken" class="md-nav__link">
      NonFungibleToken
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../aepp-sophia-examples/libraries/MultisignatureWallet/" title="MultisignatureWallet" class="md-nav__link">
      MultisignatureWallet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Getting Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../getting-started/hello-world-with-sophia/" title="HelloWorld with Sophia" class="md-nav__link">
      HelloWorld with Sophia
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../getting-started/coding-locally-with-aeproject/" title="Coding Locally with AEproject" class="md-nav__link">
      Coding Locally with AEproject
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../getting-started/deploying-on-testnet/" title="Deploying on Testnet" class="md-nav__link">
      Deploying on Testnet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../getting-started/deploying-on-mainnet/" title="Deploying on Mainnet" class="md-nav__link">
      Deploying on Mainnet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../getting-started/advance-to-do-aepp/" title="Advance ToDo aepp" class="md-nav__link">
      Advance ToDo aepp
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important" class="md-nav__link">
    Important
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#websocket-life-cycle" class="md-nav__link">
    WebSocket life cycle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-chain-requests" class="md-nav__link">
    On-chain requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pinned-environment" class="md-nav__link">
    Pinned environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-open" class="md-nav__link">
    Channel open
  </a>
  
    <nav class="md-nav" aria-label="Channel open">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#websocket-protocol" class="md-nav__link">
    Websocket protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-parameters" class="md-nav__link">
    Channel parameters
  </a>
  
    <nav class="md-nav" aria-label="Channel parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel-establishing-parameters" class="md-nav__link">
    Channel establishing parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-timeout-values" class="md-nav__link">
    Channel timeout values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-block-hash-delta-values" class="md-nav__link">
    Channel block hash delta values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-websocket-open" class="md-nav__link">
    Responder WebSocket open
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initiator-websocket-open" class="md-nav__link">
    Initiator WebSocket open
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-opened-messages" class="md-nav__link">
    Connection opened messages
  </a>
  
    <nav class="md-nav" aria-label="Connection opened messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiator-connection-opened-message" class="md-nav__link">
    Initiator connection opened message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-connection-opened-message" class="md-nav__link">
    Responder connection opened message
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-transaction-authentication" class="md-nav__link">
    Create transaction authentication
  </a>
  
    <nav class="md-nav" aria-label="Create transaction authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiator-authenticates-the-tx" class="md-nav__link">
    Initiator authenticates the tx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-is-informed" class="md-nav__link">
    Responder is informed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#responder-authenticates-the-tx" class="md-nav__link">
    Responder authenticates the tx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initiator-is-informed" class="md-nav__link">
    Initiator is informed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authenticated-channel_create_tx" class="md-nav__link">
    Authenticated channel_create_tx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-in-mempool" class="md-nav__link">
    Transaction in mempool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-detected-on-chain" class="md-nav__link">
    Transaction detected on-chain
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mininum-depth-confirmation" class="md-nav__link">
    Mininum-depth confirmation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-state" class="md-nav__link">
    Initial state
  </a>
  
    <nav class="md-nav" aria-label="Initial state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-confirmation" class="md-nav__link">
    Open confirmation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-changed" class="md-nav__link">
    State changed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-reconnect" class="md-nav__link">
    Client reconnect
  </a>
  
    <nav class="md-nav" aria-label="Client reconnect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-off-chain-update" class="md-nav__link">
    Channel off-chain update
  </a>
  
    <nav class="md-nav" aria-label="Channel off-chain update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel-state" class="md-nav__link">
    Channel state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#meta-information" class="md-nav__link">
    Meta-information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transfer" class="md-nav__link">
    Transfer
  </a>
  
    <nav class="md-nav" aria-label="Transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-transfer-update" class="md-nav__link">
    Start transfer update
  </a>
  
    <nav class="md-nav" aria-label="Start transfer update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-balances" class="md-nav__link">
    Check balances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-a-transfer-update" class="md-nav__link">
    Trigger a transfer update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starter-authenticates-updated-state" class="md-nav__link">
    Starter authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-update" class="md-nav__link">
    Finish update
  </a>
  
    <nav class="md-nav" aria-label="Finish update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-the-result-of-the-update" class="md-nav__link">
    Check the result of the update
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-contract" class="md-nav__link">
    Create a contract
  </a>
  
    <nav class="md-nav" aria-label="Create a contract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-create-contract-update" class="md-nav__link">
    Start create contract update
  </a>
  
    <nav class="md-nav" aria-label="Start create contract update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-create-contract-update" class="md-nav__link">
    Trigger a create contract update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owner-authenticates-updated-state" class="md-nav__link">
    Owner authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_1" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-update_1" class="md-nav__link">
    Finish update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contract-address-computation" class="md-nav__link">
    Contract address computation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-a-contract" class="md-nav__link">
    Call a contract
  </a>
  
    <nav class="md-nav" aria-label="Call a contract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-call-a-contract-update" class="md-nav__link">
    Start call a contract update
  </a>
  
    <nav class="md-nav" aria-label="Start call a contract update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-contract-call-update" class="md-nav__link">
    Trigger a contract call update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caller-authenticates-updated-state" class="md-nav__link">
    Caller authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_2" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-update_2" class="md-nav__link">
    Finish update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-call-result" class="md-nav__link">
    Getting a call result
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optionally-leavereestablish" class="md-nav__link">
    Optionally leave/reestablish
  </a>
  
    <nav class="md-nav" aria-label="Optionally leave/reestablish">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leave-request" class="md-nav__link">
    Leave request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reestablish" class="md-nav__link">
    Reestablish
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-mutual-close" class="md-nav__link">
    Channel mutual close
  </a>
  
    <nav class="md-nav" aria-label="Channel mutual close">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiate-mutual-close" class="md-nav__link">
    Initiate mutual close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starter-authenticating" class="md-nav__link">
    Starter authenticating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-authenticating" class="md-nav__link">
    Acknowledger authenticating
  </a>
  
    <nav class="md-nav" aria-label="Acknowledger authenticating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authenticated-channel_close_mutual_tx" class="md-nav__link">
    Authenticated channel_close_mutual_tx
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-closing" class="md-nav__link">
    Channel closing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking-the-progress-of-the-onchain-transaction" class="md-nav__link">
    Tracking the progress of the onchain transaction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-solo-close" class="md-nav__link">
    Channel solo close
  </a>
  
    <nav class="md-nav" aria-label="Channel solo close">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiate-solo-close" class="md-nav__link">
    Initiate solo close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requester-authentication" class="md-nav__link">
    Requester authentication
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-slash" class="md-nav__link">
    Channel slash
  </a>
  
    <nav class="md-nav" aria-label="Channel slash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slasher-initiates-slash" class="md-nav__link">
    Slasher initiates slash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slasher-authenticating" class="md-nav__link">
    Slasher authenticating
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-settle" class="md-nav__link">
    Channel settle
  </a>
  
    <nav class="md-nav" aria-label="Channel settle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requester-authenticating" class="md-nav__link">
    Requester authenticating
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-websocket-events" class="md-nav__link">
    Other WebSocket events
  </a>
  
    <nav class="md-nav" aria-label="Other WebSocket events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-error" class="md-nav__link">
    Open error
  </a>
  
    <nav class="md-nav" aria-label="Open error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#missing-participant" class="md-nav__link">
    Missing participant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integer-value-is-too-low" class="md-nav__link">
    Integer value is too low
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-error" class="md-nav__link">
    Timeout error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-error" class="md-nav__link">
    Update error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-conflict" class="md-nav__link">
    Update conflict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abort-update" class="md-nav__link">
    Abort update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-messages" class="md-nav__link">
    Generic messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#total-balance-update-events" class="md-nav__link">
    Total balance update events
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deposit-events" class="md-nav__link">
    Deposit events
  </a>
  
    <nav class="md-nav" aria-label="Deposit events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deposit-transaction" class="md-nav__link">
    Deposit transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-deposit" class="md-nav__link">
    Start deposit
  </a>
  
    <nav class="md-nav" aria-label="Start deposit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-deposit" class="md-nav__link">
    Trigger a deposit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#depositor-authenticates-updated-state" class="md-nav__link">
    Depositor authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_3" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-deposit" class="md-nav__link">
    Finish deposit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#withdraw-events" class="md-nav__link">
    Withdraw events
  </a>
  
    <nav class="md-nav" aria-label="Withdraw events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#withdraw-transaction" class="md-nav__link">
    Withdraw transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-withdraw" class="md-nav__link">
    Start withdraw
  </a>
  
    <nav class="md-nav" aria-label="Start withdraw">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-a-withdrawal" class="md-nav__link">
    Trigger a withdrawal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#withdrawer-authenticates-updated-state" class="md-nav__link">
    Withdrawer authenticates updated state
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledger-update_4" class="md-nav__link">
    Acknowledger update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-withdrawal" class="md-nav__link">
    Finish withdrawal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-state" class="md-nav__link">
    Getting state
  </a>
  
    <nav class="md-nav" aria-label="Getting state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-balances" class="md-nav__link">
    Get balances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-proof-of-inclusion" class="md-nav__link">
    Get proof of inclusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dry-run-a-contract" class="md-nav__link">
    Dry-run a contract
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-contract-calls" class="md-nav__link">
    Get contract calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pruning-contract-calls" class="md-nav__link">
    Pruning contract calls
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solo-closing-sequence" class="md-nav__link">
    Solo closing sequence
  </a>
  
    <nav class="md-nav" aria-label="Solo closing sequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#payload-and-proof-of-inclusion" class="md-nav__link">
    Payload and proof of inclusion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solo-close-on-chain-transaction" class="md-nav__link">
    Solo close on-chain transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slash-on-chain-transaction" class="md-nav__link">
    Slash on-chain transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settle-on-chain-transaction" class="md-nav__link">
    Settle on-chain transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-keep-alive" class="md-nav__link">
    Connection keep alive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-snapshot" class="md-nav__link">
    Channel snapshot
  </a>
  
    <nav class="md-nav" aria-label="Channel snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshotter-inittiates-a-snapshot-solo" class="md-nav__link">
    Snapshotter inittiates a snapshot solo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshotter-authenticates-the-snapshot-solo" class="md-nav__link">
    Snapshotter authenticates the snapshot solo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aeternity/documentation-hub/edit/master/docs/protocol/node/api/channels_api_usage.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <p><a href="../">back</a></p>
<h1 id="channels-intended-usage">Channels - intended usage</h1>
<h2 id="important">Important</h2>
<p>With introduction of GAs, all on-chain state channel transactions
are to be signed using the on-chain account's authentication method and
off-chain transactions are to be signed using the accounts' authentication
method at channel creation time. You can read more about it
<a href="../../../channels/authentication/">here</a>.</p>
<h2 id="introduction">Introduction</h2>
<p>You interact with an Aeternity node both through HTTP requests and WebSocket
connections.
To learn more about channels and their life cycle see <a href="/channels/README.md">the doc</a>.</p>
<p>In each channel there are two WebSocket client parties. For each channel, a
new WebSocket connection is opened. Once the channel is opened - participants
are equal in every regard. They have different roles while opening and we have
names for them - <code>initiator</code> and <code>responder</code>. For short we will call them <em>the
parties</em>.</p>
<p>There are two basic types of interaction: persisted connection events and HTTP
API calls.</p>
<p>Although no off-chain transactions consume gas or require any fees, all
on-chain transactions come with a fee. The value of the fee can be set by the
client that initiates the action, ex. a deposit. The FSM could also calculate
it for the client: it will multiply the minimum gas required for the
transaction by the gas price. The gas price could optionally be specified by
the client. If not - the node's setting for <code>min_miner_gas_price</code> is used instead.
Note that relying on the <code>min_miner_gas_price</code> could result in the fee being
either too low or too high according to dynamically changing miner
expectations for the gas price.  If both a <code>fee</code> and a <code>gas_price</code> are
provided, then the FSM computes the fee for the client according to the gas
requirements and <code>gas_price</code>. The actual fee being used for the transaction is
the larger value between the computed fee using provided <code>gas_price</code>and the
provided <code>fee</code>.</p>
<p>All on-chain transactions require a replay-attack protection. This could be
either embedded in the transaction itself or implemented in a smart contract
in the case of a Generalized Account. In the latter case the <code>nonce</code> in the
transaction is always <code>0</code>. In the case of a basic account, though, there must
be a valid <code>nonce</code> or the on-chain transaction will not be included in the
blockchain. In all APIs that produce on-chain transaction, there is an
optional parameter <code>nonce</code> for the client to specify the value to be used. If
this is not provided, the FSM will do its best defining what that value should
be. It checks all pending transactions for that account, takes the highest
nonce from them and uses it to base the next nonce. If there are no pending
transactions, the account's nonce is used instead. Note that relying on
pending transactions could significantly slow down the channel transaction
inclusion or even render it invalid.</p>
<h3 id="websocket-life-cycle">WebSocket life cycle</h3>
<p>These are used for the scenario when all parties behave correctly and as
expected. The flow is the following:</p>
<ol>
<li><a href="#channel-open">Channel open</a></li>
<li><a href="#client-reconnect">Client reconnect</a></li>
<li><a href="#channel-off-chain-update">Channel off-chain update</a></li>
<li><a href="#transfer">Transfer</a></li>
<li><a href="#create-a-contract">Create a contract</a></li>
<li><a href="#call-a-contract">Call a contract</a></li>
<li><a href="#leave-reestablish">Optionally leave/reestablish</a></li>
<li><a href="#channel-mutual-close">Channel mutual close</a></li>
<li><a href="#channel-solo-close">Channel solo close</a></li>
<li><a href="#channel-slash">Channel slash</a></li>
<li><a href="#channel-settle">Channel settle</a></li>
<li><a href="#channel-snapshot">Optionally snapshot</a></li>
</ol>
<p>There are a some WebSocket events that can occur while the connection is open
but are not necessarily part of the channel's life cycle.</p>
<ul>
<li>
<p><a href="#open-error">Open error</a></p>
</li>
<li>
<p><a href="#timeout-error">Timeout error</a></p>
</li>
<li>
<p><a href="#update-error">Update error</a></p>
</li>
<li>
<p><a href="#update-conflict">Update conflict</a></p>
</li>
<li>
<p><a href="#abort-update">Abort update</a></p>
</li>
<li>
<p><a href="#generic-messages">Generic messages</a></p>
</li>
<li>
<p><a href="#deposit-events">Deposit</a></p>
</li>
<li>
<p><a href="#withdraw-events">Withdrawal</a></p>
</li>
<li>
<p><a href="#getting-state">Getting state</a></p>
</li>
<li>
<p><a href="#get-balances">Balances</a></p>
</li>
<li>
<p><a href="#get-proof-of-inclusion">Proof of inclusion</a></p>
</li>
<li>
<p><a href="#dry-run-a-contract">Dry-run a contract</a></p>
</li>
<li>
<p><a href="#get-contract-calls">Contract call</a></p>
</li>
<li>
<p><a href="#pruning-contract-calls">Cleaning local contract calls</a></p>
</li>
<li>
<p><a href="#connection-keep-alive">Connection keep alive</a></p>
</li>
</ul>
<p>Only steps 1 and 4 require chain interactions, step 2 and 3 are off-chain.</p>
<h3 id="on-chain-requests">On-chain requests</h3>
<p>There are two types of requests:
* Total amount-modifying ones - <a href="#deposit-transaction">deposit</a> and <a href="#withdraw-transaction">withdrawal</a>
* <a href="#solo-closing-sequence">Channel-closing ones</a> - <a href="#solo-close-on-chain-transaction">solo close</a>, <a href="#slash-on-chain-transaction">slash</a> and <a href="#settle-on-chain-transaction">settle</a></p>
<h3 id="pinned-environment">Pinned environment</h3>
<p>While on-chain consensus is reached between miners, in off-chain world we
don't have those. State channels are two-party systems that are closer to
proof-of-stake solutions where both participants have equal
stake in the channel, no matter their balances. The channel can make another
step forward only if both parties agree upon the new state or it is produced
via a force progress transaction on-chain that had been based upon a previous
mutually agreed state. This makes channels both trustless and egalitarian.</p>
<p>This trustless model is based upon both participants executing off-chain
updates locally and reaching the same results. This is how consensus is
reached between them. Since off-chain smart contracts can read on-chain
objects like accounts, names, contracts and oracles requests and responses,
the results of their execution rely heavily on the chain environment they are
based on.</p>
<p>Participants are expected to use their own nodes to support their channels.
At the moment using a service hosted by a third party is trustful, thus
potentially undesirable. This leads to both participant's nodes being peers in
a system with an eventual consistency - due to network constraints and forks
both participants can have a different view of the chain.</p>
<p>The combination of participants having different views on the chain and the
off-chain consensus being dependent on it could lead to a fragile system with
a lot of mismatching state hashes of off-chain updates. In order to improve
this there is an optional functionality of setting <code>block_hash</code> that defines
the on-chain environment that the update is to be executed in. We call this
shared view of the chain <em>a pinnned environment</em>. When a participant wants to
start a new round of updates, one can optionally specify a pinned environment
to execute in. This is how the participant communicates to the other party
what one considers to be a block hash that is safe enough to base an off-chain
update upon. The other party might decide if the block hash is too old or too
new depending on their local view of the chain. If the specified pinned
environment does not meet the expectations, the whole update is rejected as
invalid.</p>
<p>An update might not be pinned to any environment. In that case a placeholder
value for the blockhash is provided:
<code>"kh_11111111111111111111111111111111273Yts"</code> or
<code>"mh_11111111111111111111111111111111273Yts"</code>. In this case both participants
use whatever they see to be the latest top block.</p>
<p>The <code>block_hash</code> is an optional argument to all mutual offchain transactions. If it is
not explicitly provided by the requester, a suitable value is picked for the
client by their FSM.</p>
<h2 id="channel-open">Channel open</h2>
<p>In order to use a channel, it must be opened. Both parties negotiate parameters for the channel - for example the amounts to participate. Some of those are relevant to the chain and end up in a<code>channel_create_tx</code> that is posted on the chain. Once a certain amount of blocks have been mined on top of the one that included it, the channel is considered to be opened.</p>
<h3 id="websocket-protocol">Websocket protocol</h3>
<p>The channel websocket api currently supports one protocol: <a href="https://www.jsonrpc.org/specification"><code>json-rpc</code></a>. <code>legacy</code> protocol was removed. Choosen protocol has to be specified with the <code>protocol</code> option.</p>
<p>In the examples below, the <code>json-rpc</code> protocol is used.</p>
<p>Detailed message transcripts from test suites can also be found <a href="./examples/channels/json-rpc/">here</a>.</p>
<h3 id="channel-parameters">Channel parameters</h3>
<p>Each channel has a set of parameters that is required for opening a
connection. Most of those are part of the <code>channel_create_tx</code> which is included
in the chain, and the others are metadata used for the connection itself. We
will describe these in groups which indicate their relation to each other.</p>
<h4 id="channel-establishing-parameters">Channel establishing parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Required for open</th>
<th>Required/Used in reestablish</th>
<th>Part of the <code>channel_create_tx</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>initiator_id</td>
<td>string</td>
<td>initiator's public key</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>responder_id</td>
<td>string</td>
<td>responder's public key</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>lock_period</td>
<td>integer</td>
<td>amount of blocks for disputing a solo close</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>push_amount</td>
<td>integer</td>
<td>initial deposit in favour of the responder by the initiator</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>initiator_amount</td>
<td>integer</td>
<td>amount of tokens the initiator has committed to the channel</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>responder_amount</td>
<td>integer</td>
<td>amount of tokens the responder has committed to the channel</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>channel_reserve</td>
<td>integer</td>
<td>the minimum amount both peers need to maintain</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>maximum height of a block to include the <code>channel_create_tx</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>host</td>
<td>string</td>
<td>host of the <code>responder</code>'s node</td>
<td>Yes if <code>role=initiator</code></td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>port</td>
<td>integer</td>
<td>the port of the <code>responder</code>s node</td>
<td>Yes if <code>role=initiator</code></td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>role</td>
<td>string</td>
<td>the role of the client - either <code>initiator</code> or <code>responder</code></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>minimum_depth</td>
<td>integer</td>
<td>the minimum amount of blocks to be mined</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>the fee to be used for the channel open transaction</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation of the channel open transaction</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p><code>responder</code>'s port and host pair must be reachable from <code>initiator</code> network
  so unless participants are part of a LAN, they should be exposed to the
  internet as described <a href="../">here</a>. It is possible to use the
  same port number for different responder pubkeys and multiple simultaneous
  responders. If the <code>responder</code> sets <code>initiator_id</code> to <code>"any"</code>, the responder will
  accept a connection request from any initiator, and fetch the proper <code>initiator_id</code>
  from the <code>channel_open</code> message.</p>
<p>Once established, the channel follows a <a href="/channels/README.md#overview">predefined set of state
  transitions</a>. The implementation protects the
  client from edge cases when transitions take too long or never happen using
  a set of different timers - if the event doesn't occur in the specified time
  frame then the off-chain protocol is considered to be violated and the
  WebSocket connection is killed. Those are optionally configurable alongside
  with the channel establish settings. Keep in mind that those are only local
  values for the specific participant, protecting one's own interest. The two
  participants can have different timeout settings and still doing updates, as
  long as no timer fires.</p>
<h4 id="channel-timeout-values">Channel timeout values</h4>
<p>All timeout values are integers and represent the waiting time in
  milliseconds.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>timeout_idle</td>
<td>the time waiting for a new event to be initiated</td>
<td>600000</td>
</tr>
<tr>
<td>timeout_funding_create</td>
<td>the time waiting for the <code>initiator</code> to produce the create channel transaction after the <code>noise</code> session had been established</td>
<td>120000</td>
</tr>
<tr>
<td>timeout_funding_sign</td>
<td>the time frame the other client has to authenticate an off-chain update after our client had initiated and authenticated it. This applies only for mutual authentication of on-chain intended updates: channel create transaction, deposit, withdrawal and etc.</td>
<td>120000</td>
</tr>
<tr>
<td>timeout_funding_lock</td>
<td>the time frame the other client has to confirm an on-chain transaction reaching maturity (passing minimum depth) after the local node has detected this. This applies only for mutually authenticated on-chain intended updates: channel create transaction, deposit, withdrawal and etc.</td>
<td>360000</td>
</tr>
<tr>
<td>timeout_sign</td>
<td>the time frame the client has to return an authenticated off-chain update or to decline it. This applies for all off-chain updates</td>
<td>500000</td>
</tr>
<tr>
<td>timeout_accept</td>
<td>the time frame the other client has to react to an event. This applies for all off-chain updates that are not meant to land on-chain, as well as some special cases: opening a <code>noise</code> connection, mutual closing acknowledgement and reestablishing an existing channel</td>
<td>120000</td>
</tr>
<tr>
<td>timeout_initialized</td>
<td>the time frame the responder has to accept an incoming noise session. Applicable only for initiator</td>
<td>timeout_accept's value</td>
</tr>
<tr>
<td>timeout_awaiting_open</td>
<td>the time frame the initiator has to start an outgoing noise session to the responder's node. Applicable only for responder</td>
<td>timeout_idle's value</td>
</tr>
</tbody>
</table>
<p>In the following examples we will be using the following parameters:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>initiator_id</td>
<td>ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm</td>
</tr>
<tr>
<td>responder_id</td>
<td>ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC</td>
</tr>
<tr>
<td>lock_period</td>
<td>10</td>
</tr>
<tr>
<td>push_amount</td>
<td>1</td>
</tr>
<tr>
<td>initiator_amount</td>
<td>70000000000000</td>
</tr>
<tr>
<td>responder_amount</td>
<td>40000000000000</td>
</tr>
<tr>
<td>channel_reserve</td>
<td>2</td>
</tr>
<tr>
<td>ttl</td>
<td>1000</td>
</tr>
</tbody>
</table>
<p>The <code>initiator</code> will be connecting to the <code>responder</code> on localhost:12340
  We will be using the tool <a href="https://github.com/websockets/wscat">wscat</a>
  We assume the channel's WebSocket listener is set on port 3014 (default one)</p>
<h4 id="channel-block-hash-delta-values">Channel block hash delta values</h4>
<p>A client can specify what is considered by them to be a valid block hash.
  Those are defined as deltas according to the latest chain top as seen from
  the participant's node. A delta of <code>0</code> is the latest top, a delta of <code>1</code> is
  the previous generation, etc. Each participant can set a delta which defines
  a range of accepted heights according to the current top. If the other
  participant makes an off-chain update based on a hash which refers to a
  block belonging to a generation outside of this range - it will be rejected
  as it would be considered unsafe.</p>
<p>Additionally to the delta range check for incoming updates, the FSM also can
  pick a correct block hash for the client. This happens when the client
  starts a new update round and a block hash is not specified by the client.
  Then the FSM checks what is the newest allowed block hash according to the
  range. An additional pick offset can be provided for even greater fork
  safety.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td>bh_delta_not_newer_than</td>
<td>height delta to be allowed as the newest possible relative to local top</td>
<td>0</td>
</tr>
<tr>
<td>bh_delta_not_older_than</td>
<td>height delta to be allowed as the oldest possible relative to local top</td>
<td>10</td>
</tr>
<tr>
<td>bh_delta_pick</td>
<td>the offset according to <code>bh_delta_not_newer_than</code> to use when picking a block hash for the client</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Restrictions on them are that:
  * <code>bh_delta_not_newer_than &gt;= 0</code>
  * <code>bh_delta_not_newer_than + bh_delta_pick &gt;= bh_delta_not_older_than</code>
  * if one is set, the other one must also be set</p>
<p>If any of the checks fails, the defaults are used instead.</p>
<h3 id="responder-websocket-open">Responder WebSocket open</h3>
<p>Using the set of prenegotiated parameters the responder connects</p>
<pre><code>$ wscat --connect 'localhost:3014/channel?channel_reserve=2&amp;initiator_amount=70000000000000&amp;initiator_id=ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&amp;lock_period=10&amp;port=12340&amp;protocol=json-rpc&amp;push_amount=1&amp;responder_amount=40000000000000&amp;responder_id=ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&amp;role=responder'

connected (press CTRL+C to quit)
</code></pre>

<p>Note the <code>role=responder</code> as it is specific. Note also that the <code>host</code> is missing - it is not required for the responder.
The <code>port</code> being specified is the one the <code>responder</code>'s node will start
listening for the <code>initiator</code>'s connection. If the <code>responder</code>'s node is
behind a firewall or some port forwarding is done - this should be done before
the initiator starts connecting as it will fail.</p>
<p>At this point the <code>responder</code> is listening on address <code>0.0.0.0</code> for the <code>initiator</code>'s
connection on the specified port - <code>12340</code>.</p>
<h3 id="initiator-websocket-open">Initiator WebSocket open</h3>
<p>Using the set of prenegotiated parameters the initiator connects</p>
<pre><code>$ wscat --connect 'localhost:3014/channel?channel_reserve=2&amp;host=localhost&amp;initiator_amount=70000000000000&amp;initiator_id=ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&amp;lock_period=10&amp;port=12340&amp;protocol=json-rpc&amp;push_amount=1&amp;responder_amount=40000000000000&amp;responder_id=ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&amp;role=initiator'

connected (press CTRL+C to quit)
</code></pre>

<p>Note the <code>role=initiator</code> as it is specific. Note also the <code>host</code> and <code>port</code>
values being provided by the <code>responder</code>.</p>
<h3 id="connection-opened-messages">Connection opened messages</h3>
<p>Parties' WebSocket clients receive messages for the opening of the TCP
connection.</p>
<h4 id="initiator-connection-opened-message">Initiator connection opened message</h4>
<p>The initiator receives the following message</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;channel_accept&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="responder-connection-opened-message">Responder connection opened message</h4>
<p>The responder receives the following message</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;channel_open&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="create-transaction-authentication">Create transaction authentication</h3>
<p>The <code>channel_create_tx</code> is sent subsequently to both parties and they mutually
authenticate it. Then it is posted to the chain.</p>
<h4 id="initiator-authenticates-the-tx">Initiator authenticates the tx</h4>
<p>The initiator receives a message containing the unauthenticated transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.initiator_sign&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+IEyAaEB...&quot;,
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Initiator is to decode the transaction, inspect its contents, authenticate it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.initiator_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+MsLAfhCu...&quot;
  }
}
</code></pre>

<h4 id="responder-is-informed">Responder is informed</h4>
<p>The responder receives the following message</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;funding_created&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="responder-authenticates-the-tx">Responder authenticates the tx</h4>
<p>After being informed for the initiator's authentication, the responder receives a message containing the solo-authenticated transaction to be co-authenticated by her as well</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.responder_sign&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+MsLAfhCu...&quot;,
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same transaction that the initiator already
authenticated and same updates list. Responder is to decode the transaction,
inspect its contents, to co-authenticate it, encode it and then to post
it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.responder_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+MsLAfhCP4...&quot;,
  }
}
</code></pre>

<h4 id="initiator-is-informed">Initiator is informed</h4>
<p>The initiator receives the following message</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;funding_signed&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="authenticated-channel_create_tx">Authenticated channel_create_tx</h4>
<p>The responder FSM reports to its client that it received the authentication
reply, and now has a co-authenticated <code>channel_create_tx</code>. It relies on the
initiator to push the co-authenticed transaction to the mempool:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;funding_created&quot;,
      &quot;tx&quot;: &quot;tx_+MsLAfhCP4...&quot;,
      &quot;type&quot;: &quot;channel_create_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The initiator FSM reports to its client that it received the co-authenticated
<code>channel_create_tx</code> from the responder:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;funding_signed&quot;,
      &quot;tx&quot;: &quot;tx_+MsLAfhCP4...&quot;,
      &quot;type&quot;: &quot;channel_create_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="transaction-in-mempool">Transaction in mempool</h4>
<p>At this point both parties had received the mutually authenticated the <code>channel_create_tx</code> transaction. The transaction is posted by the state
channel's software to the node and goes to the mempool. Having calculated its hash, one can validate it using the external HTTP API:</p>
<pre><code>$ curl 'http://localhost:3013/v2/transactions/th_hNyHzj4dSzyBqReAMR36GGz1mhuXxQFuES3AnPkXkuY2w6dZb'
</code></pre>

<p>if the <code>block_hash</code> is <code>none</code> - then the transaction is still in the mempool.</p>
<h4 id="transaction-detected-on-chain">Transaction detected on-chain</h4>
<p>Once the transaction is picked up by a miner and included in a block, the FSMs will detect it and report
a <code>channel_changed</code> event in an <code>on_chain_tx</code> report:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;channel_changed&quot;,
      &quot;tx&quot;: &quot;tx_+QENCwH4hLhAKOlyL6Y5R1OgoyQ8+8QdDya72IT479ncEFi7BnPO3zMyE4N/E54E2heF3g8aCYirv/ajwxB5DIDn2cdEF6h6ALhA2ILrieAe4Y8a+0lfSwmN+ddIv6gPX0xfMyX4RpQ7BRZoINayCRQNOxGci9v2J7to+CSYNJQEYzBXcSTclpoXCbiD+IEyAaEBsbV3vNMnyznlXmwCa9anShs13mwGUMSuUe+rdZ5BW2aGP6olImAAoQFnHFVGRklFdbK0lPZRaCFxBmPYSJPN0tI2A3pUwz7uhIYkYTnKgAACCgCGG0jrV+AAwKCjPk7CXWjSHTO8V2Y9WTad6D/5sB8yCR8WumWh0WxWvwMXN1eS&quot;,
      &quot;type&quot;: &quot;channel_create_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="mininum-depth-confirmation">Mininum-depth confirmation</h3>
<p>A block height timer is started and it ends after <code>minimum_depth + 1</code> confirmations. Default value for
it is 4, so 5 blocks need to be mined. As a result, each party will receive
two kinds of confirmation.</p>
<p>An update from one's own node that the block height needed is reached:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;own_funding_locked&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>An update from one's own node that the other party had confirmed that the block
height needed is reached:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;funding_locked&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="initial-state">Initial state</h3>
<p>After both parties have confirmed that the funding is authenticated - they can proceed
with sending the messages for off-chain updates. The inital state is the one
described in the create transaction.</p>
<h4 id="open-confirmation">Open confirmation</h4>
<p>After both parties have mutually authenticated the state update both of them will receive a info for the channel open:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;open&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>From this point on, the channel is considered to be opened.</p>
<h4 id="state-changed">State changed</h4>
<p>Each time the FSM returns to the <code>open</code> state, it will check whether the channel off-chain state has
changed. If so, it issues a <code>channels.update</code> report. When the channel is first opened, this report will
present the initial off-chain state:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+QENCwH4hLhAKOlyL6Y5R1OgoyQ8+8QdDya72IT479ncEFi7BnPO3zMyE4N/E54E2heF3g8aCYirv/ajwxB5DIDn2cdEF6h6ALhA2ILrieAe4Y8a+0lfSwmN+ddIv6gPX0xfMyX4RpQ7BRZoINayCRQNOxGci9v2J7to+CSYNJQEYzBXcSTclpoXCbiD+IEyAaEBsbV3vNMnyznlXmwCa9anShs13mwGUMSuUe+rdZ5BW2aGP6olImAAoQFnHFVGRklFdbK0lPZRaCFxBmPYSJPN0tI2A3pUwz7uhIYkYTnKgAACCgCGG0jrV+AAwKCjPk7CXWjSHTO8V2Y9WTad6D/5sB8yCR8WumWh0WxWvwMXN1eS&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="client-reconnect">Client reconnect</h3>
<p>Once the <code>channel_create_tx</code> has been signed, the client Websocket connection may close
without causing the FSM to terminate. The client may reconnect by signing a special
<code>channel_client_reconnect_tx</code> transaction, partly to identify the right FSM instance
to connect to, and partly to prove identity. The transaction has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel</td>
</tr>
<tr>
<td>round</td>
<td>integer</td>
<td>Must be higher than at the last reconnect</td>
</tr>
<tr>
<td>role</td>
<td>string</td>
<td>Role of the instance (initiator or responder)</td>
</tr>
<tr>
<td>pub key</td>
<td>string</td>
<td>Public key of the client</td>
</tr>
</tbody>
</table>
<p>Information about serialization can be found <a href="../../../serializations/#channel-client-reconnect-transaction">here</a>.</p>
<p>After signing the reconnect transaction, the client connects using the parameters <code>protocol</code>
and <code>reconnect_tx</code> as illustrated below. Note that the <code>reconnect_tx</code> parameter uses a
serialized transaction.</p>
<pre><code>$ wscat --connect 'localhost:3014/channel?protocol=json-rpc&amp;reconnect_tx=tx_%2BJ0LAfhCuECD0kyElzq1A4bRqUUlIvwqo3UpNLZr07K6f6ZzCMjOY6nVLowEyewiEfDOGu0yy%2BrS2pSOWZzumSKLpNAOwQsBuFX4U4ICPwGhBiPYP7m2R8Z36J9C1yWyKO6C0GoclMWjkh8mGyYcwiNkAYlpbml0aWF0b3KhARZ7k%2B1MUXursizzqkphuO8bCDRo8DrnsRvekHG5Ry3bV0P6XA%3D%3D'

connected (press CTRL+C to quit)
</code></pre>

<p>While the client is disconnected, the corresponding FSM will reject any
protocol request that requires signing. An attempt to reconnect to an FSM that
already has a client connected will be rejected. Note, however, that if e.g.
an update request already includes the authentication of the disconnected
client, the operation is allowed, and the responding FSM proceeds as if it had
issued an authentication request and received a successful reply.</p>
<h4 id="example">Example</h4>
<p>Assuming that the channel has been set up, and the <code>initiator</code> and <code>responder</code> both have
received corresponding <code>channels.update</code> messages:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2qHR2iopmhCpRq1NYKcqXkAM4ydhKrqCiwyNushZrH94L6TQ4r&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+QENCwH4hLhAqJaduFrTCqaxqF9uEDPVbd6nkl/cLzuNqQo4n7Unc9SZK8uWVyRTvbPL8AP4Zo/c9giz5ip9Au7qyGmoNRRhD7hAuur2dr0f4rmoiYQaJn51XGm26ksdM6UdCTGJcJSoPXNT9qaWKdiT/1uDXhUuv6L92JlkWPoqNdxAgoZgGozdDriD+IEyAaEBczX34JBR7Jaa9oTSdI0jePPWlUuTx7E0OO/D32FaT2CGP6olImAAoQECgVxNp3bgfaAQOCDBXtlM1JpBTJJK4MgaN+bFPvE9VoYkYTnKgAACCgCGEAZ510gAwKB7Hn2psAENZRcUm0kl3cMq7J6YaBSioPNTsxFw3H8aFAHEJFnz&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>If the <code>initiator</code> client now disconnects, its FSM will keep running.</p>
<p>If the <code>responder</code> now initiates an update request, the <code>initiator</code> FSM
will respond with a <code>conflict</code> error.</p>
<pre><code>#### responder ---&gt; node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update.new&quot;,
  &quot;params&quot;: {
    &quot;amount&quot;: 1,
    &quot;from&quot;: &quot;ak_26zhrAPuCdcFD5f68BgRrHza8LS1wUrKKLHco21mjcBqcfwdU&quot;,
    &quot;to&quot;: &quot;ak_sjuXT1xcbLNFvbMcYBerZuRF8QckyiHY7nBVjVTC1ZXauwGYY&quot;
  }
}

#### responder &lt;--- node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2qHR2iopmhCpRq1NYKcqXkAM4ydhKrqCiwyNushZrH94L6TQ4r&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+E0LAcC4SPhGOQKhBvFUHNvTaJmM0h7WZRyILi7R5xEube4cPidh39qA4rZ3AqA1OxWEaCmQrMsRAz/aOqULrCfnjvXy3CsSqurneRAweq1oQ2o=&quot;,
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 1,
          &quot;from&quot;: &quot;ak_26zhrAPuCdcFD5f68BgRrHza8LS1wUrKKLHco21mjcBqcfwdU&quot;,
          &quot;op&quot;: &quot;OffChainTransfer&quot;,
          &quot;to&quot;: &quot;ak_sjuXT1xcbLNFvbMcYBerZuRF8QckyiHY7nBVjVTC1ZXauwGYY&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}

#### responder ---&gt; node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+JALAfhCuEC9qolUALwHM2t73ZWgLujcu2EPv3IWOBll9bmMb0WIJcCqHnz/ZBf3VHxlPWb/VWCY9wp/Z4MOoqqtiLwpApEGuEj4RjkCoQbxVBzb02iZjNIe1mUciC4u0ecRLm3uHD4nYd/agOK2dwKgNTsVhGgpkKzLEQM/2jqlC6wn54718twrEqrq53kQMHpotH/U&quot;
  }
}

#### responder &lt;--- node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.conflict&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2qHR2iopmhCpRq1NYKcqXkAM4ydhKrqCiwyNushZrH94L6TQ4r&quot;,
    &quot;data&quot;: {
      &quot;channel_id&quot;: &quot;ch_2qHR2iopmhCpRq1NYKcqXkAM4ydhKrqCiwyNushZrH94L6TQ4r&quot;,
      &quot;round&quot;: 1
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>If, on the other hand, the <code>responder</code> FSM manages to get <code>initiator</code> to
co-authenticate the initial request (e.g. optically by exchanging QR codes),
the <code>initiator</code> FSM will detect the existence of its client's authentication,
and will acknowledge the request.</p>
<pre><code>#### responder ---&gt; node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update.new&quot;,
  &quot;params&quot;: {
    &quot;amount&quot;: 1,
    &quot;from&quot;: &quot;ak_26zhrAPuCdcFD5f68BgRrHza8LS1wUrKKLHco21mjcBqcfwdU&quot;,
    &quot;to&quot;: &quot;ak_sjuXT1xcbLNFvbMcYBerZuRF8QckyiHY7nBVjVTC1ZXauwGYY&quot;
  }
}

#### responder &lt;--- node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2qHR2iopmhCpRq1NYKcqXkAM4ydhKrqCiwyNushZrH94L6TQ4r&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+E0LAcC4SPhGOQKhBvFUHNvTaJmM0h7WZRyILi7R5xEube4cPidh39qA4rZ3AqA1OxWEaCmQrMsRAz/aOqULrCfnjvXy3CsSqurneRAweq1oQ2o=&quot;,
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 1,
          &quot;from&quot;: &quot;ak_26zhrAPuCdcFD5f68BgRrHza8LS1wUrKKLHco21mjcBqcfwdU&quot;,
          &quot;op&quot;: &quot;OffChainTransfer&quot;,
          &quot;to&quot;: &quot;ak_sjuXT1xcbLNFvbMcYBerZuRF8QckyiHY7nBVjVTC1ZXauwGYY&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}

#### responder ---&gt; node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+NILAfiEuEB2kYkTBh9xELqllJZzHMFcj9oysyo4t6sBbxWI1tm2LZmkh9liZbwHyzNADWjj9FywzWpVceUfiVWhXfwHXFIFuEC9qolUALwHM2t73ZWgLujcu2EPv3IWOBll9bmMb0WIJcCqHnz/ZBf3VHxlPWb/VWCY9wp/Z4MOoqqtiLwpApEGuEj4RjkCoQbxVBzb02iZjNIe1mUciC4u0ecRLm3uHD4nYd/agOK2dwKgNTsVhGgpkKzLEQM/2jqlC6wn54718twrEqrq53kQMHqW0FMw&quot;
  }
}

#### responder &lt;--- node
{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2qHR2iopmhCpRq1NYKcqXkAM4ydhKrqCiwyNushZrH94L6TQ4r&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+NILAfiEuEB2kYkTBh9xELqllJZzHMFcj9oysyo4t6sBbxWI1tm2LZmkh9liZbwHyzNADWjj9FywzWpVceUfiVWhXfwHXFIFuEC9qolUALwHM2t73ZWgLujcu2EPv3IWOBll9bmMb0WIJcCqHnz/ZBf3VHxlPWb/VWCY9wp/Z4MOoqqtiLwpApEGuEj4RjkCoQbxVBzb02iZjNIe1mUciC4u0ecRLm3uHD4nYd/agOK2dwKgNTsVhGgpkKzLEQM/2jqlC6wn54718twrEqrq53kQMHqW0FMw&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h2 id="channel-off-chain-update">Channel off-chain update</h2>
<p>After the channel has been opened and before it has been closed there is a
channel state that is updated when needed. The updates are off-chain and
broadcasted only between parties in the channel. The state is a full state
tree that holds all the latest accounts, contracts and contract calls.
A state is considered to be valid only if both parties have agreed upon it.
Agreement it proven with authenticating a message that contains the channel id, round
and root of the state tree (state_hash). States are ordered by their round - the greater the round,
the newer the state. The latest channel state is the last valid state, having
the greatest round. At any time the latest state can be used for unilaterally closing the channel.</p>
<h3 id="channel-state">Channel state</h3>
<p>There are a couple of different types that could define the channel state.
Those are deposit, withdrawal and off-chain transactions. They all containt at
least the following data:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel</td>
</tr>
<tr>
<td>state_hash</td>
<td>string</td>
<td>root of the state tree</td>
</tr>
<tr>
<td>round</td>
<td>integer</td>
<td>current round</td>
</tr>
</tbody>
</table>
<p>You can find further information for them as it follows:</p>
<ul>
<li><a href="../../../serializations/#channel-deposit-transaction">deposit transaction</a></li>
<li><a href="../../../serializations/#channel-withdraw-transaction">withdrawal transaction</a></li>
<li><a href="../../../serializations/#channel-off-chain-transaction">off-chain transaction</a></li>
</ul>
<p>Each subsequent state has a <code>round</code> increased with 1</p>
<p>Since both participants are peers, they can both trigger new updates to the
state.
Since one of them starts the update and the other acknowledges is below we are
going to use <code>starter</code> and <code>acknowledger</code>. Both the initiator and the
responder can take either of the roles.</p>
<h3 id="meta-information">Meta-information</h3>
<p>Update requests that modify the off-chain state can be optionally annotated with
<code>meta</code> information objects. The parameter <code>"meta": [ string() ]</code> may be added, and each
meta information object can be an arbitrary string. Operations that support this are
transfer (<code>update.new</code>), <code>deposit</code>, <code>withdrawal</code>, <code>new_contract</code> and <code>call_contract</code>.
Meta information does not get included in on-chain transactions, nor does it affect the
state hash. It can be used to convey useful application-level information to the other
party in the channel.</p>
<p>Example:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update.new&quot;,
  &quot;params&quot;: {
    &quot;amount&quot;: &quot;1&quot;,
    &quot;from&quot;: &quot;ak_txXinM233n3S1TiLArz5NmGTQtxZoYnia29HU4dPjVS2bthQe&quot;,
    &quot;meta&quot;: [
      &quot;meta 1&quot;
    ],
    &quot;to&quot;: &quot;ak_K3boWaT4GXP2hENENPnVnCmJSHjeHbHaszkJQsNGuTWyD4PMq&quot;
  }
}
</code></pre>

<h3 id="transfer">Transfer</h3>
<p>The transfer update is moving tokens from one channel account to another. The update is a change to be applied on top of the latest state. It has the
following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>from</td>
<td>string</td>
<td>sender's public key</td>
</tr>
<tr>
<td>to</td>
<td>string</td>
<td>receiver's public key</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>the amount given</td>
</tr>
</tbody>
</table>
<p>Sender and receiver are the channel parties. Both the initiator and responder
can take those roles. Any public key outside of the channel is considered invalid.</p>
<h4 id="start-transfer-update">Start transfer update</h4>
<h5 id="check-balances">Check balances</h5>
<p>To check the outcome of the following sequence, we can first check the balances of the channel:</p>
<pre><code class="javascript">{
  &quot;id&quot;: -576460752303423471,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.balances&quot;,
  &quot;params&quot;: {
    &quot;accounts&quot;: [
      &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
    ]
  }
}
</code></pre>

<p>The FSM responds:</p>
<pre><code class="javascript">{
  &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
  &quot;id&quot;: -576460752303423471,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: [
    {
      &quot;account&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;balance&quot;: 69999999999999
    },
    {
      &quot;account&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
      &quot;balance&quot;: 40000000000001
    }
  ],
  &quot;version&quot;: 1
}
</code></pre>

<h5 id="trigger-a-transfer-update">Trigger a transfer update</h5>
<p>The starter sends a message containing the desired change</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update.new&quot;,
  &quot;params&quot;: {
    &quot;amount&quot;: 1,
    &quot;from&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
    &quot;to&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
  }
}
</code></pre>

<p>The <code>starter</code> might take the role of <code>from</code> or <code>to</code> so the <code>starter</code> can
trigger sending or request for tokens.</p>
<h5 id="starter-authenticates-updated-state">Starter authenticates updated state</h5>
<p>The starter receives a message containing the updated channel state as an
off-chain transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+EY5AqEGrATZCq2SbvoJPO8phULArHp0My7fBW9SSptJ+5ys02ICoNUqd4GTOFacRsLar0VqTNSHraQXvmyQrL/MBqX090LhVgB6xw==&quot;,
      &quot;signed_tx&quot;: &quot;tx_+JU5AaEGrAT...&quot;,
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 1,
          &quot;from&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
          &quot;op&quot;: &quot;OffChainTransfer&quot;,
          &quot;to&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The starter is to decode the transaction, inspect its contents, authenticates it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+N8LAfhCu...&quot;,
  }
}
</code></pre>

<h4 id="acknowledger-update">Acknowledger update</h4>
<p>The acknowledger receives an info message indicating an upcoming change:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;update&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Then the acknowledger receives a new message containing the updated channel state as an
off-chain transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update_ack&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+N8LAfhCu...&quot;,
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 1,
          &quot;from&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
          &quot;op&quot;: &quot;OffChainTransfer&quot;,
          &quot;to&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same solo-authenticated transaction. The acknowledger is
to decode the transaction, inspect its contents, authenticate it, encode it and
then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update_ack&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+N8LAfhC...&quot;
  }
}
</code></pre>

<h4 id="finish-update">Finish update</h4>
<p>After both the parties have authenticated the new updated state of the channel - it is
considered the latest one. Corresponding update messages are sent to both
parties to indicate it. The payload of the message contains the latest
mutually authenticated off-chain update so the participants can persist it locally.</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+N8LAfhC...&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h5 id="check-the-result-of-the-update">Check the result of the update</h5>
<p>Since we checked balances before the update, we can do so again to verify the result:</p>
<pre><code class="javascript">{
  &quot;id&quot;: -576460752303423470,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.balances&quot;,
  &quot;params&quot;: {
    &quot;accounts&quot;: [
      &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
    ]
  }
}
</code></pre>

<p>The FSM responds:</p>
<pre><code class="javascript">{
  &quot;channel_id&quot;: &quot;ch_2Jkzb1BVaA888pdNgxoBjJWQKCMiJRxjLbG972dH6cSC3ULwGK&quot;,
  &quot;id&quot;: -576460752303423470,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: [
    {
      &quot;account&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;balance&quot;: 69999999999998
    },
    {
      &quot;account&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
      &quot;balance&quot;: 40000000000002
    }
  ],
  &quot;version&quot;: 1
}
</code></pre>

<p>After that a new state updated can be triggered.</p>
<h3 id="create-a-contract">Create a contract</h3>
<p>The create contract update is creating a contract inside the channel's internal state tree. The update is a change to be applied on top of the latest state. It has the
following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>vm_version</td>
<td>integer</td>
<td>version of the AEVM</td>
</tr>
<tr>
<td>abi_version</td>
<td>integer</td>
<td>version of the ABI</td>
</tr>
<tr>
<td>deposit</td>
<td>integer</td>
<td>initial amount the owner of the contract commits to it</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>api encoded compiled AEVM byte code</td>
</tr>
<tr>
<td>call_data</td>
<td>string</td>
<td>api encoded compiled AEVM call data for the code</td>
</tr>
</tbody>
</table>
<p>That would create a contract with the poster being the <code>owner</code> of it. Poster
commits initially a <code>deposit</code> amount of tokens to the new contract.</p>
<h4 id="start-create-contract-update">Start create contract update</h4>
<h5 id="trigger-a-create-contract-update">Trigger a create contract update</h5>
<p>The owner sends a message containing the desired change</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update.new_contract&quot;,
  &quot;params&quot;: {
    &quot;abi_version&quot;: 1,
    &quot;call_data&quot;: &quot;cb_AAAAAAAA...&quot;,
    &quot;code&quot;: &quot;cb_+QP1RgKg/ukoF...&quot;,
    &quot;deposit&quot;: 10,
    &quot;vm_version&quot;: 3
  }
}
</code></pre>

<h5 id="owner-authenticates-updated-state">Owner authenticates updated state</h5>
<p>The owner receives a message containing the updated channel state as an
off-chain transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QTXOQGhB...&quot;,
      &quot;updates&quot;: [
        {
          &quot;abi_version&quot;: 1,
          &quot;call_data&quot;: &quot;cb_AAAAAAAA...&quot;,
          &quot;code&quot;: &quot;cb_+QP1RgKg/ukoF...&quot;,
          &quot;deposit&quot;: 10,
          &quot;op&quot;: &quot;OffChainNewContract&quot;,
          &quot;owner&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
          &quot;vm_version&quot;: 3
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The owner is to decode the transaction, inspect its contents, authenticate it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QUjCw...&quot;
  }
}
</code></pre>

<h4 id="acknowledger-update_1">Acknowledger update</h4>
<p>The acknowledger receives an info message indicating an upcoming change:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;update&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Then the acknowledger receives a new message containing the updated channel state as an
off-chain transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update_ack&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QUjCw...&quot;
      &quot;updates&quot;: [
        {
          &quot;abi_version&quot;: 1,
          &quot;call_data&quot;: &quot;cb_AAAAAAAA...&quot;,
          &quot;code&quot;: &quot;cb_+QP1RgKg/ukoF...&quot;,
          &quot;deposit&quot;: 10,
          &quot;op&quot;: &quot;OffChainNewContract&quot;,
          &quot;owner&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
          &quot;vm_version&quot;: 3
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same solo-authenticated transaction. The acknowledger
is to decode the transaction, inspect its contents, authenticate it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update_ack&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QUjCwH4QrhA...&quot;
  }
}
</code></pre>

<h4 id="finish-update_1">Finish update</h4>
<p>After both the parties have authenticated the new updated state of the channel - it is
considered the latest one. Corresponding update messages are sent to both
parties to indicate it. The payload of the message contains the latest
mutually authenticated off-chain update so the participants can persist it locally.</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+QUjCwH4QrhA...&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>After that a new state updated can be triggered.</p>
<h4 id="contract-address-computation">Contract address computation</h4>
<p>The created contract is part of the state tree. It has its own balance and its
place in the contracts subtree of the channel's state tree. In order to
inspect its balance or call the contract one needs its address.</p>
<p>Computation of this address is done exactly as it is in on-chain contracts -
it is a hashed version of the channel's owner pubkey and the nonce. Only
difference is that nonce is not computated in channels and the update round is
used instead.</p>
<h3 id="call-a-contract">Call a contract</h3>
<p>The call contract update is calling a preexisting contract inside the channel's internal state tree. The update is a change to be applied on top of the latest state. It has the
following structure.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>contract_id</td>
<td>string</td>
<td>address of the contract to call</td>
</tr>
<tr>
<td>abi_version</td>
<td>integer</td>
<td>version of the ABI</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>amount the caller of the contract commits to it</td>
</tr>
<tr>
<td>call_data</td>
<td>string</td>
<td>ABI encoded compiled AEVM call data for the code</td>
</tr>
</tbody>
</table>
<p>That would call a contract with the poster being the <code>caller_id</code> of it. Poster
commits an <code>amount</code> amount of tokens to the contract.</p>
<p>The call would also create a <code>call</code> object inside the channel state tree. It contains the result of the contract call.</p>
<h4 id="start-call-a-contract-update">Start call a contract update</h4>
<h5 id="trigger-a-contract-call-update">Trigger a contract call update</h5>
<p>The caller sends a message containing the desired change</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update.call_contract&quot;,
  &quot;params&quot;: {
    &quot;abi_version&quot;: 1,
    &quot;amount&quot;: 0,
    &quot;call_data&quot;: &quot;cb_AAAAAAAAA...&quot;,
    &quot;contract_id&quot;: &quot;ct_2Yy7TpPUs7SCm9jkCz7vz3nkb18zs78vcuVQGbgjRaWQNTWpm5&quot;
  }
}
</code></pre>

<h5 id="caller-authenticates-updated-state">Caller authenticates updated state</h5>
<p>The caller receives a message containing the updated channel state as an
off-chain transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QEeOQGhBoKHx...&quot;,
      &quot;updates&quot;: [
        {
          &quot;abi_version&quot;: 1,
          &quot;amount&quot;: 0,
          &quot;call_data&quot;: &quot;cb_AAAAAAAAA...&quot;,
          &quot;call_stack&quot;: [],
          &quot;caller_id&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
          &quot;contract_id&quot;: &quot;ct_2Yy7TpPUs7SCm9jkCz7vz3nkb18zs78vcuVQGbgjRaWQNTWpm5&quot;,
          &quot;gas&quot;: 1000000,
          &quot;gas_price&quot;: 1,
          &quot;op&quot;: &quot;OffChainCallContract&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The caller is to decode the transaction, inspect its contents, authenticate it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QFqCwH4...&quot;
  }
}
</code></pre>

<h4 id="acknowledger-update_2">Acknowledger update</h4>
<p>The acknowledger receives an info message indicating an upcoming change:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;update&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Then the acknowledger receives a new message containing the updated channel state as an
off-chain transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.update_ack&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QFqCwH4...&quot;
      &quot;updates&quot;: [
        {
          &quot;abi_version&quot;: 1,
          &quot;amount&quot;: 0,
          &quot;call_data&quot;: &quot;cb_AAAAAAAAA...&quot;,
          &quot;call_stack&quot;: [],
          &quot;caller_id&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
          &quot;contract_id&quot;: &quot;ct_2Yy7TpPUs7SCm9jkCz7vz3nkb18zs78vcuVQGbgjRaWQNTWpm5&quot;,
          &quot;gas&quot;: 1000000,
          &quot;gas_price&quot;: 1,
          &quot;op&quot;: &quot;OffChainCallContract&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same solo-authenticated transaction. The acknowledger is
to decode the transaction, inspect its contents, authenticate it, encode it and
then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update_ack&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QFqCwH4Q...&quot;
  }
}
</code></pre>

<h4 id="finish-update_2">Finish update</h4>
<p>After both the parties have authenticated the new updated state of the channel - it is
considered the latest one. Corresponding update messages are sent to both
parties to indicate it. The payload of the message contains the latest
mutually authenticated off-chain update so the participants can persist it locally.</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+QFqCwH4Q...&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="getting-a-call-result">Getting a call result</h4>
<p>All calls are stored in the channel state tree. In order to extract one out of
there and inspect it, one shall send a WebSocket event</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.contract_call&quot;,
  &quot;params&quot;: {
    &quot;caller_id&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
    &quot;contract_id&quot;: &quot;ct_2Yy7TpPUs7SCm9jkCz7vz3nkb18zs78vcuVQGbgjRaWQNTWpm5&quot;,
    &quot;round&quot;: 8
  }
}
</code></pre>

<p>The <code>contract_id</code> is the address of the contract that had been called, the <code>round</code> is the round of the update and
<code>caller_id</code> is the address of the caller.</p>
<p>Then the call is returned through an incoming message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.contract_call.reply&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;caller_id&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
      &quot;caller_nonce&quot;: 8,
      &quot;contract_id&quot;: &quot;ct_2Yy7TpPUs7SCm9jkCz7vz3nkb18zs78vcuVQGbgjRaWQNTWpm5&quot;,
      &quot;gas_price&quot;: 1,
      &quot;gas_used&quot;: 192,
      &quot;height&quot;: 8,
      &quot;log&quot;: [],
      &quot;return_type&quot;: &quot;ok&quot;,
      &quot;return_value&quot;: &quot;cb_AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACr8s/aY&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>It is worth mentioning that since this is an off-chain transaction the gas price specified is not consumed.
That amount of gas represents the amount of computations. It could be used for
aproximation for the gas needed for executing a contract on-chain if a similar amount of
computations are required. Computation heavy contracts might be just too
expensive to be force progressed on-chain, so please use with caution.</p>
<h2 id="optionally-leavereestablish"><a name="leave-reestablish"></a>Optionally leave/reestablish</h2>
<p>It is possible to leave a channel and then later reestablish the channel
off-chain state and continue operation. Leaving the channel can either be
done by simply disconnecting, or by sending a <code>'leave'</code> request. When receving
a leave request, the channel FSM passes it on to the peer FSM, reports the
current mutually authenticated state and then terminates. The <code>'reestablish'</code> request
is very similar to a <a href="#channel-open">Channel open</a> request, but also requires
the channel id and the latest mutually authenticated state.</p>
<p>The full state, including state trees, is cached internally by the Aeternity
node, and upon reestablish, it is verified that the encoded state provided
by the client corresponds to the latest full state retrieved from the cache.</p>
<h3 id="leave-request">Leave request</h3>
<p>Example:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.leave&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<p>The FSM responds with the following type of report:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.leave&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+QENCwH4hLh...&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="reestablish">Reestablish</h3>
<p>Open the channel in the same way as in the
<a href="#initiator-websocket-open">Initiator WebSocket open</a> example,
adding the parameters <code>existing_channel_id</code> and <code>offchain_tx</code> with values
matching the ones provided in the <code>leave</code> report above. Some parameters (related to open transaction) are not required and ignored. See <a href="#channel-parameters">Channel parameters</a>:</p>
<pre><code>$ wscat --connect
localhost:3014/channel?existing_channel_id=ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&amp;host=localhost&amp;offchain_tx=tx_%2BQENCwH4h...&amp;port=12341&amp;protocol=json-rpc&amp;role=initiator
</code></pre>

<p>The channel FSM responds with the following event reports if all goes well:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: null,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;channel_reestablished&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>then the standard report indicating that the channel is open:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;open&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>followed by an update report with the latest mutually authenticated state:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.update&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;state&quot;: &quot;tx_+QENCwH4...&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h2 id="channel-mutual-close">Channel mutual close</h2>
<p>At any moment after the channel is opened, a closing procedure can be
triggered. This can be done by either of the parties. The process is similar to
the <a href="#channel-off-chain-update">off-chain updates</a>. The most notable change is the
special transaction mutually authenticated. It is called
<code>channel_close_mutual_tx</code>. After gathering singatures it will end up on the
chain and has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel</td>
</tr>
<tr>
<td>from</td>
<td>string</td>
<td>initiator's public key</td>
</tr>
<tr>
<td>initiator_amount_final</td>
<td>integer</td>
<td>final amount of tokens to be awarded by the initiator</td>
</tr>
<tr>
<td>responder_amount_final</td>
<td>integer</td>
<td>final amount of tokens to be awarded by the responder</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>maximum block height to include the transaction</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>fee to be paid to the miner</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation</td>
</tr>
<tr>
<td>nonce</td>
<td>integer</td>
<td>initiator's nonce</td>
</tr>
</tbody>
</table>
<p>Since any of the participants can initiate a closing, we will use <code>starter</code>
for the peer that triggers the process and <code>acknowledger</code> for the other one.</p>
<h3 id="initiate-mutual-close">Initiate mutual close</h3>
<p>The starter sends the following message and triggers the closing procedure:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.shutdown&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<h3 id="starter-authenticating">Starter authenticating</h3>
<p>Then the starter receives a <code>channel_close_mutual_tx</code> to authenticate:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.shutdown_sign&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_iNuPMRW1pCL17hXT8nHQgW1vMKfpBdsvztuYdM2VpPRh8PYVP&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+F01AaEGXfP...&quot;,
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Starter is to decode the transaction, inspect its contents, authenticate it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.shutdown_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+KcLAfhC...&quot;
  }
}
</code></pre>

<h3 id="acknowledger-authenticating">Acknowledger authenticating</h3>
<p>Then the acknowledger receives a <code>channel_close_mutual_tx</code> to authenticate:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.shutdown_sign_ack&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_iNuPMRW1pCL17hXT8nHQgW1vMKfpBdsvztuYdM2VpPRh8PYVP&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+KcLAfhC...&quot;
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same solo-authenticed transaction. The acknowledger is
to decode the transaction, inspect its contents, authenticate it, encode it and
then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.shutdown_sign_ack&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+KcLAfhCuE...&quot;
  }
}
</code></pre>

<h4 id="authenticated-channel_close_mutual_tx">Authenticated channel_close_mutual_tx</h4>
<p>Both participants receive the mutually authenticated <code>channel_close_mutual_tx</code>:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_iNuPMRW1pCL17hXT8nHQgW1vMKfpBdsvztuYdM2VpPRh8PYVP&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;close_mutual&quot;,
      &quot;tx&quot;: &quot;tx_+KcLAfhCuE...&quot;,
      &quot;type&quot;: &quot;channel_close_mutual_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Using its hash, participants can track its progress on the chain: entering the mempool, block inclusion and a number of confirmations.</p>
<h3 id="channel-closing">Channel closing</h3>
<p>After both parties have received the mutually authenticated <code>channel_close_mutual_tx</code>
transaction, it is posted on the chain and the microservice handling the
off-chain requests dies. Parties receive the following infos:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_iNuPMRW1pCL17hXT8nHQgW1vMKfpBdsvztuYdM2VpPRh8PYVP&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;close_mutual&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_iNuPMRW1pCL17hXT8nHQgW1vMKfpBdsvztuYdM2VpPRh8PYVP&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;died&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Then the WebSocket connection is closed.</p>
<h3 id="tracking-the-progress-of-the-onchain-transaction">Tracking the progress of the onchain transaction</h3>
<p>After calculating the hash of the mutually authenticated <code>channel_close_mutual_tx</code> parties can track
its progress as they would do with any on-chain transaction</p>
<pre><code>curl 'http://127.0.0.1:3013/v2/transactions/th_2qkN973cNJiejXVJoXkXbttf1iKetWJCSY1W5VUBh3pnRS1kCC'
</code></pre>

<p>if the <code>block_hash</code> is <code>none</code> - then the transaction is still in the mempool.</p>
<h2 id="channel-solo-close">Channel solo close</h2>
<p>It is possible to close the channel unilaterally, e.g. if the other party has
disconnected and is expected never to return. The channel FSM can be asked
to generate a <code>channel_close_solo_tx</code> transaction and post it on-chain. The
resulting transaction will include the latest mutually signed offchain state,
or the empty string, indicating that the latest state is what's on the chain.</p>
<p>The <code>channel_close_solo_tx</code> transaction only needs a single authentication, and
is described in more detail in <a href="#channel-solo-close">this section</a>.</p>
<p>The channel FSM does not support picking an earlier state to close with, as
this is a form of cheating.</p>
<p>Since any of the participants can initiate a solo-closing, we will use
<code>requester</code> for the peer that triggers the process. The other peer is not
necessarily involved at all, but will be informed if it is actually connected.
For this description, we simply call it <code>other</code>.</p>
<h3 id="initiate-solo-close">Initiate solo close</h3>
<p>The requester sends the following message and triggers the closing procedure:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.close_solo&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<h3 id="requester-authentication">Requester authentication</h3>
<p>Then the requester receives a <code>channel_close_solo_tx</code> to authenticate:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.close_solo_sign&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QGfNgGhBnHSbcHwBwtR5QRwS0O1mI1Gw/8pkaOwcHQap09BPoMFoQGxtXe80yfL
OeVebAJr1qdKGzXebAZQxK5R76t1nkFbZoC5AUz5AUk8AfkBP/kBPKAeoRWJfw9r7+McQQHdwLN6tS/a
qbQUwm8iJYXMIOcncfkBGPh0oB6hFYl/D2vv4xxBAd3As3q1L9qptBTCbyIlhcwg5ydx+FGAgICAgICg7QIWPGJsh916G7zCAZpUeaRQuGVamwjR8JaxQKEPIwmAgICAoEJmfgNwrMeYsFATTDpQ+Y9abOcHR6KUvw5o9LdShJsUgICAgID4T6BCZn4DcKzHmLBQE0w6UPmPWmznB0eilL8OaPS3UoSbFO2gMbV3vNMnyznlXmwCa9anShs13mwGUMSuUe+rdZ5BW2aLygoBAIY/qiUiX//4T6DtAhY8YmyH3XobvMIBmlR5pFC4ZVqbCNHwlrFAoQ8jCe2gNxxVRkZJRXWytJT2UWghcQZj2EiTzdLSNgN6VMM+7oSLygoBAIYkYTnKgAHAwMDAwACGG0jrV+AACPykTFA=&quot;,
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Requester is to decode the transaction, inspect its contents, authenticate it, encode it
and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.close_solo_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QHrCwH4QrhACuHMgbcTg1inUPAUSmhXfODKWI2CFchqpav9VDaBlw+xng9Ld0eLPgysTvks47iVHn4d/11VlkEi6iLRBDkIBLkBovkBnzYBoQZx0m3B8AcLUeUEcEtDtZiNRsP/KZGjsHB0GqdPQT6DBaEBsbV3vNMnyznlXmwCa9anShs13mwGUMSuUe+rdZ5BW2aAuQFM+QFJPAH5AT/5ATygHqEViX8Pa+/jHEEB3cCzerUv2qm0FMJvIiWFzCDnJ3H5ARj4dKAeoRWJfw9r7+McQQHdwLN6tS/aqbQUwm8iJYXMIOcncfhRgICAgICAoO0CFjxibIfdehu8wgGaVHmkULhlWpsI0fCWsUChDyMJgICAgKBCZn4DcKzHmLBQE0w6UPmPWmznB0eilL8OaPS3UoSbFICAgICA+E+gQmZ+A3Csx5iwUBNMOlD5j1ps5wdHopS/Dmj0t1KEmxTtoDG1d7zTJ8s55V5sAmvWp0obNd5sBlDErlHvq3WeQVtmi8oKAQCGP6olIl//+E+g7QIWPGJsh916G7zCAZpUeaRQuGVamwjR8JaxQKEPIwntoDccVUZGSUV1srSU9lFoIXEGY9hIk83S0jYDelTDPu6Ei8oKAQCGJGE5yoABwMDAwMAAhhtI61fgAAiybuMt&quot;
  }
}
</code></pre>

<p>As the channel FSM receives the authenticated solo close transaction, verifies it
and posts it to the chain, it should eventually detect the transaction appearing
on the chain, and inform its client with the following WebSocket message.
The other peer will receive the same message if it is online:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;solo_closing&quot;,
      &quot;tx&quot;: &quot;tx_+QHrCwH4QrhACuHMgbcTg1inUPAUSmhXfODKWI2CFchqpav9VDaBlw+xng9Ld0eLPgysTvks47iVHn4d/11VlkEi6iLRBDkIBLkBovkBnzYBoQZx0m3B8AcLUeUEcEtDtZiNRsP/KZGjsHB0GqdPQT6DBaEBsbV3vNMnyznlXmwCa9anShs13mwGUMSuUe+rdZ5BW2aAuQFM+QFJPAH5AT/5ATygHqEViX8Pa+/jHEEB3cCzerUv2qm0FMJvIiWFzCDnJ3H5ARj4dKAeoRWJfw9r7+McQQHdwLN6tS/aqbQUwm8iJYXMIOcncfhRgICAgICAoO0CFjxibIfdehu8wgGaVHmkULhlWpsI0fCWsUChDyMJgICAgKBCZn4DcKzHmLBQE0w6UPmPWmznB0eilL8OaPS3UoSbFICAgICA+E+gQmZ+A3Csx5iwUBNMOlD5j1ps5wdHopS/Dmj0t1KEmxTtoDG1d7zTJ8s55V5sAmvWp0obNd5sBlDErlHvq3WeQVtmi8oKAQCGP6olIl//+E+g7QIWPGJsh916G7zCAZpUeaRQuGVamwjR8JaxQKEPIwntoDccVUZGSUV1srSU9lFoIXEGY9hIk83S0jYDelTDPu6Ei8oKAQCGJGE5yoABwMDAwMAAhhtI61fgAAiybuMt&quot;,
      &quot;type&quot;: &quot;channel_close_solo_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>As the channel object status also changes to <code>closing</code>, the peer(s) will
receive another information message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;closing&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h2 id="channel-slash">Channel slash</h2>
<p>If a <code>channel_close_solo_tx</code> passes on-chain checks, it is valid to the best
of the miner's knowledge. The channel is to be closed and the final balances
participants receive from its closure are according to whatever state had
been provided last on-chain.</p>
<p>The state given by the <code>channel_solo_close_tx</code> can be progressed using a channel force progress
transaction. Each new <code>channel_force_progress_tx</code> transaction will result in a
new channel state that is produced on-chain. It will have a new <code>state_hash</code>
and an incremented <code>round</code>.</p>
<p>On the other hand the <code>channel_close_solo_tx</code> could have been both valid and
malicious at the same time: it could have passed all on-chain checks but yet
it might not have been the very last channel state. If any participant tries
to close the channel unilaterally using a <code>channel_close_solo_tx</code> based upon
an earlier (i.e. not the latest) channel state, we would consider that a violation of the
off-chain protocol. In that case the other participant can defend themselves
from being cheated by simply providing a co-authenticated off-chain state with
a higher round. This is done via the <code>channel_slash_tx</code> transaction.</p>
<p>Since a co-authenticated off-chain state has a higher priority than an
unilaterally on-chain produced one via a <code>channel_force_progress_tx</code> transaction, 
a <code>channel_slash_tx</code> transaction can invalidate a whole chain of
<code>channel_force_progress_tx</code> transactions if the first one of them had been based
on a channel state that is older than the one provided by the <code>channel_slash_tx</code>
transaction. This way if one party produces a long chain of force-progressed
states based on a not-the-last state, the other can replace them all providing
a single <code>channel_slash_tx</code> transaction.</p>
<p>For completeness it is worth mentioning that the second party can be malicious
as well, not providing the very last state in their <code>channel_slash_tx</code>
transaction. In that case the closing party could protect themselves with yet
another <code>channel_slash_tx</code> transaction that slashes the slash that is now
on-chain as well as all force-progressed states based upon it. Having this
mechanics at place aims at incentivizing both parties to behave well as all
cheating attempts will cost them on-chain fees.</p>
<p>If the other party tries closing the channel with a <code>channel_close_solo_tx</code>
that is not based on the latest off-chain state, our FSM informs us about it
(note the <code>"info": "can_slash"</code> bit):</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_Et72swxcKCAJ8KzUDm17X1Ukuo6W7516WfYDPdUoTYpArCdfQ&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;can_slash&quot;,
      &quot;tx&quot;: &quot;tx_+NILAfiEuEBCNNHFxu/R+ypbtOCh7BrA+oFrAYYHzhZTR8BmTOgO2yYKd7lXwU7+xlfvD3Mu9dEeVp1T1aVuH8UPk/7wU9UMuECR/+7ZaF0OqeiRuRVkjsd2aEynOBmBk+tFETlA5H/jNIVB2A1RbKDe8yHGBWpUbWZzLnPXK+pl1Wkml094WxUAuEj4RjkCoQYfhMxkEg4U4IPqO0HIxeove0RQjLQ6xewjm9BZLWhckwKgKhvZeiagtdVqx9aMKxKhw8+hK5cMrAWcpuiI9OVBfAcDKgN0&quot;,
      &quot;type&quot;: &quot;channel_offchain_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>As well as this message, the client receives a message that informs them that
the channel has now entered a closing state:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_Et72swxcKCAJ8KzUDm17X1Ukuo6W7516WfYDPdUoTYpArCdfQ&quot;,
    &quot;data&quot;: 
      &quot;event&quot;: &quot;closing&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="slasher-initiates-slash">Slasher initiates slash</h4>
<p>The party that had been prompted to slash is to inspect the closing transaction and
decide if it wants to slash. There is the scenario when one would pay more
in on-chain fees compared to what is to be lost if one allows the channel
being closed with some older state. If one decides to slash, one simply sends:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.slash&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<h4 id="slasher-authenticating">Slasher authenticating</h4>
<p>Then the slasher receives a <code>channel_slash_tx</code> to authenticate:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.slash_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_Et72swxcKCAJ8KzUDm17X1Ukuo6W7516WfYDPdUoTYpArCdfQ&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QJ9CwHAuQJ3+QJ0NwGhBh+EzGQSDhTgg+o7QcjF6i97RFCMtDrF7COb0FktaFyToQHFuOyHaFZbIrWNtYfyrvdxCqjuxxEHg9OIAavLpCy79LjU+NILAfiEuEBCNNHFxu/R+ypbtOCh7BrA+oFrAYYHzhZTR8BmTOgO2yYKd7lXwU7+xlfvD3Mu9dEeVp1T1aVuH8UPk/7wU9UMuECR/+7ZaF0OqeiRuRVkjsd2aEynOBmBk+tFETlA5H/jNIVB2A1RbKDe8yHGBWpUbWZzLnPXK+pl1Wkml094WxUAuEj4RjkCoQYfhMxkEg4U4IPqO0HIxeove0RQjLQ6xewjm9BZLWhckwKgKhvZeiagtdVqx9aMKxKhw8+hK5cMrAWcpuiI9OVBfAe5AUz5AUk8AfkBP/kBPKBr5sKqJEGy2c6K7OYj3B0QSM9YKqp12Cwu0FcoBE12iPkBGPhPoEqVXL/Gi63p37+99IW1AH7Eb//F/0G9uCVe9zFlBvdG7aAxNm8xdRGfaP8NRS1ZqdGmmsRo8FaC1wW2VWFid7ROEIvKCgEAhiRhOcqAAvh0oGvmwqokQbLZzors5iPcHRBIz1gqqnXYLC7QVygETXaI+FGAgICAgICAgICAgICgbYJjbN6iM9NklD1uSm6sox3iiItBMXXpvq1p2MXyRnGgSpVcv8aLrenfv730hbUAfsRv/8X/Qb24JV73MWUG90aAgID4T6BtgmNs3qIz02SUPW5KbqyjHeKIi0Exdem+rWnYxfJGce2gNbjsh2hWWyK1jbWH8q73cQqo7scRB4PTiAGry6Qsu/SLygoBAIY/qiUiX/7AwMDAwACGGR7ISegAEhFhZsM=&quot;,
      &quot;updates&quot;&gt;&gt; =&gt; []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The slasher is to decode the transaction, inspect its contents, authenticate
it, encode it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.slash_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QLACwH4QrhAsEn+SKhPLOh7mmKoHpj4+OQZaHnVatjP8PUnwci+Xn5RzA4mR36at5rK/5j5l1FZGieSga4SOTHX1SY4o9huAbkCd/kCdDcBoQYfhMxkEg4U4IPqO0HIxeove0RQjLQ6xewjm9BZLWhck6EBxbjsh2hWWyK1jbWH8q73cQqo7scRB4PTiAGry6Qsu/S41PjSCwH4hLhAQjTRxcbv0fsqW7TgoewawPqBawGGB84WU0fAZkzoDtsmCne5V8FO/sZX7w9zLvXRHladU9Wlbh/FD5P+8FPVDLhAkf/u2WhdDqnokbkVZI7HdmhMpzgZgZPrRRE5QOR/4zSFQdgNUWyg3vMhxgVqVG1mcy5z1yvqZdVpJpdPeFsVALhI+EY5AqEGH4TMZBIOFOCD6jtByMXqL3tEUIy0OsXsI5vQWS1oXJMCoCob2XomoLXVasfWjCsSocPPoSuXDKwFnKboiPTlQXwHuQFM+QFJPAH5AT/5ATyga+bCqiRBstnOiuzmI9wdEEjPWCqqddgsLtBXKARNdoj5ARj4T6BKlVy/xout6d+/vfSFtQB+xG//xf9BvbglXvcxZQb3Ru2gMTZvMXURn2j/DUUtWanRpprEaPBWgtcFtlVhYne0ThCLygoBAIYkYTnKgAL4dKBr5sKqJEGy2c6K7OYj3B0QSM9YKqp12Cwu0FcoBE12iPhRgICAgICAgICAgICAoG2CY2zeojPTZJQ9bkpurKMd4oiLQTF16b6tadjF8kZxoEqVXL/Gi63p37+99IW1AH7Eb//F/0G9uCVe9zFlBvdGgICA+E+gbYJjbN6iM9NklD1uSm6sox3iiItBMXXpvq1p2MXyRnHtoDW47IdoVlsitY21h/Ku93EKqO7HEQeD04gBq8ukLLv0i8oKAQCGP6olIl/+wMDAwMAAhhkeyEnoABJ3oirv\&quot;
  }
}
</code></pre>

<p>The FSM is to check the contents and the authentication of the transaction and
then post it on-chain from behalf of the slasher. Once the transaction is
included on-chain, the participant will receive a message informing them:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_Et72swxcKCAJ8KzUDm17X1Ukuo6W7516WfYDPdUoTYpArCdfQ&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;solo_closing&quot;,
      &quot;tx&quot;: &quot;tx_+QLACwH4QrhAsEn+SKhPLOh7mmKoHpj4+OQZaHnVatjP8PUnwci+Xn5RzA4mR36at5rK/5j5l1FZGieSga4SOTHX1SY4o9huAbkCd/kCdDcBoQYfhMxkEg4U4IPqO0HIxeove0RQjLQ6xewjm9BZLWhck6EBxbjsh2hWWyK1jbWH8q73cQqo7scRB4PTiAGry6Qsu/S41PjSCwH4hLhAQjTRxcbv0fsqW7TgoewawPqBawGGB84WU0fAZkzoDtsmCne5V8FO/sZX7w9zLvXRHladU9Wlbh/FD5P+8FPVDLhAkf/u2WhdDqnokbkVZI7HdmhMpzgZgZPrRRE5QOR/4zSFQdgNUWyg3vMhxgVqVG1mcy5z1yvqZdVpJpdPeFsVALhI+EY5AqEGH4TMZBIOFOCD6jtByMXqL3tEUIy0OsXsI5vQWS1oXJMCoCob2XomoLXVasfWjCsSocPPoSuXDKwFnKboiPTlQXwHuQFM+QFJPAH5AT/5ATyga+bCqiRBstnOiuzmI9wdEEjPWCqqddgsLtBXKARNdoj5ARj4T6BKlVy/xout6d+/vfSFtQB+xG//xf9BvbglXvcxZQb3Ru2gMTZvMXURn2j/DUUtWanRpprEaPBWgtcFtlVhYne0ThCLygoBAIYkYTnKgAL4dKBr5sKqJEGy2c6K7OYj3B0QSM9YKqp12Cwu0FcoBE12iPhRgICAgICAgICAgICAoG2CY2zeojPTZJQ9bkpurKMd4oiLQTF16b6tadjF8kZxoEqVXL/Gi63p37+99IW1AH7Eb//F/0G9uCVe9zFlBvdGgICA+E+gbYJjbN6iM9NklD1uSm6sox3iiItBMXXpvq1p2MXyRnHtoDW47IdoVlsitY21h/Ku93EKqO7HEQeD04gBq8ukLLv0i8oKAQCGP6olIl/+wMDAwMAAhhkeyEnoABJ3oirv&quot;,
      &quot;type&quot;: &quot;channel_slash_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h2 id="channel-settle">Channel settle</h2>
<p>Once a 'dispute' process has been initiated with a <code>channel_close_solo_tx</code>, and
once the lock period has expired, it is possible to finally close the channel
with a <code>channel_settle_tx</code> transaction. The channel FSM can assist if asked
with the following WebSocket request:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.settle&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<h4 id="requester-authenticating">Requester authenticating</h4>
<p>Then the requester receives a <code>channel_settle_tx</code> to authenticate:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.settle_sign&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+F04AaEGcdJtwfAHC1HlBHBLQ7WYjUbD/ymRo7BwdBqnT0E+gwWhAWccVUZGSUV1srSU9lFoIXEGY9hIk83S0jYDelTDPu6Ehj+qJSJf/4YkYTnKgAEAhhtI61fgAAIwYkCX&quot;,
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The requester is to decode the transaction, inspect its contents, authenticate it,
encode it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.settle_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+KcLAfhCuEBdI4Uesh3hYjGQ2BAo0FzD1YPyZlzhy8HyNgf7OzrQdVM44oWQX0yFtmk31HaSLuIJGNDv3hEgdLwe0iZz3LEEuF/4XTgBoQZx0m3B8AcLUeUEcEtDtZiNRsP/KZGjsHB0GqdPQT6DBaEBZxxVRkZJRXWytJT2UWghcQZj2EiTzdLSNgN6VMM+7oSGP6olIl//hiRhOcqAAQCGG0jrV+AAAgurGvs=&quot;
  }
}
</code></pre>

<p>As the channel FSM receives the authenticated settle transaction, verifies it
and posts it to the chain, it should eventually detect the transaction appearing
on the chain, and inform its client with the following WebSocket message.
The other peer will receive the same message if it is online:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;channel_closed&quot;,
      &quot;tx&quot;: &quot;tx_+KcLAfhCuEBdI4Uesh3hYjGQ2BAo0FzD1YPyZlzhy8HyNgf7OzrQdVM44oWQX0yFtmk31HaSLuIJGNDv3hEgdLwe0iZz3LEEuF/4XTgBoQZx0m3B8AcLUeUEcEtDtZiNRsP/KZGjsHB0GqdPQT6DBaEBZxxVRkZJRXWytJT2UWghcQZj2EiTzdLSNgN6VMM+7oSGP6olIl//hiRhOcqAAQCGG0jrV+AAAgurGvs=&quot;,
      &quot;type&quot;: &quot;channel_settle_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Once the FSM has confirmed the transaction to be safely on-chain, the following
information message is sent to the connected peers, signaling that the channel
is finally closed, and the channel object removed:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_s8RwBYpaPCPvUxvDsoLxH9KTgSV6EPGNjSYHfpbb4BL4qudgR&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;closed_confirmed&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="other-websocket-events">Other WebSocket events</h3>
<h4 id="open-error">Open error</h4>
<p>At channel's WebSocket connection is opened according to initial parameters.
If correct, everything proceeds as planned. If there are some issues with
them, the user receives an error describing the issue and the WebSocket
connection is closed.</p>
<h5 id="missing-participant">Missing participant</h5>
<p>If a user tries opening a WebSocket and either of the participants is not
present on-chain, the message received is:</p>
<pre><code class="javascript">{
   &quot;channel_id&quot;:null,
   &quot;error&quot;:{
      &quot;code&quot;:3,
      &quot;data&quot;:[
         {
            &quot;code&quot;:1011,
            &quot;message&quot;:&quot;Participant not found&quot;
         }
      ],
      &quot;message&quot;:&quot;Rejected&quot;,
      &quot;request&quot;:{
      }
   },
   &quot;id&quot;:null,
   &quot;jsonrpc&quot;:&quot;2.0&quot;,
   &quot;version&quot;:1
}
</code></pre>

<p>Note that since it is the <code>initiator</code> that pays the <code>channel_create_tx</code>
transaction fee, it is a must that the <code>initiator</code> is present on-chain.
Although this is not the case with the <code>responder</code>, having too litle coins in
their on-chain balance is a risk both parties must clearly understand: this
could make it impossible for them to make a dispute. A missing <code>responder</code> is
still rejected in the WebSocket connection to protect them from doing this
error involuntary.</p>
<h5 id="integer-value-is-too-low">Integer value is too low</h5>
<p>If a user tries opening a WebSocket and any of the integer values is too low
the message received is:</p>
<pre><code class="javascript">{
   &quot;channel_id&quot;:null,
   &quot;error&quot;:{
      &quot;code&quot;:3,
      &quot;data&quot;:[
         {
            &quot;code&quot;:105,
            &quot;message&quot;:&quot;Value too low&quot;
         }
      ],
      &quot;message&quot;:&quot;Rejected&quot;,
      &quot;request&quot;:{
      }
   },
   &quot;id&quot;:null,
   &quot;jsonrpc&quot;:&quot;2.0&quot;,
   &quot;version&quot;:1
}
</code></pre>

<p>Examples for this would be either opening amount being below the threshold
defined by <code>channel_reserve</code>, or any of <code>channel_reserve</code>, <code>push_amount</code> or
<code>lock_period</code> being a negative number.</p>
<h4 id="timeout-error">Timeout error</h4>
<p>In order to prevent zombie states of the state channel which run indefinitely
the protocol defines a set of timeouts for each participant a set of timeouts
defined by each specific participant <a href="#channel-parameters">at WebSocket connection opening
time</a>. A triggered timeout is a violation of the
off-chain protocol and the non-responsive participant is considered to be
missing. In this case the connection is interrupted and the client is expected
either to try reaching for the other party and reconnecting or going through
the solo closing sequence.</p>
<p>The client receives the following message indicating the timeout:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_...&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;timeout&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Subsequently the client receives the following message indicating the closing of
the WebSocket connection:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_...&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;died&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="update-error">Update error</h4>
<p>Updates are not always successful, for example one participant tries to spend
more tokens that one currently has in the channel's balance. This diverges
from the update flow <a href="#channel-off-chain-update">described above</a>.</p>
<p>Example message for when the <code>from</code> does not have enough tokens to spend</p>
<pre><code class="javascript">{
  &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
  &quot;error&quot;: {
    &quot;code&quot;: 3,
    &quot;data&quot;: [
      {
        &quot;code&quot;: 1001,
        &quot;message&quot;: &quot;Insufficient balance&quot;
      }
    ],
    &quot;message&quot;: &quot;Rejected&quot;,
    &quot;request&quot;: {
      &quot;jsonrpc&quot;: &quot;2.0&quot;,
      &quot;method&quot;: &quot;channels.update.new&quot;,
      &quot;params&quot;: {
        &quot;amount&quot;: 10000000000000000,
        &quot;from&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
        &quot;to&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;
      }
    }
  },
  &quot;id&quot;: null,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;version&quot;: 1
}
</code></pre>

<p>The structure is having a <code>reason</code> and <code>request</code> holding the request being
sent. Possible error reasons are:</p>
<ul>
<li>
<p><code>Insufficient balance</code> - when <code>from</code> does not have enough tokens in the
  channel. Keep in mind that there is a minimal amount of <code>channel_reserve</code>
  tokens to be kept by both parties.</p>
</li>
<li>
<p><code>Negative amount</code> - the <code>udpate</code> event contained a negative amount</p>
</li>
<li>
<p><code>Invalid pubkeys</code> - at least one of the addresses in the <code>update</code> event is
  not present in the channel.</p>
</li>
</ul>
<h4 id="update-conflict">Update conflict</h4>
<p>Since updates can be triggered by either party, it is possible both
participants to start an <code>update</code> almost simultaneously. If a new <code>update</code> is
started by a participant while the other participant has started an <code>update</code> of
ones' own - a conflict occurs. Then both <code>update</code>-s are invalidated and the
state is reverted to the last mutually authenticated one. Both participant receive a
message containing a reference to the correct state.</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.conflict&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
      &quot;round&quot;: 5
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="abort-update">Abort update</h4>
<p>The update flow relies on participants reaching agreement according to
updates. The process of getting there is not changing the channel state and
thus is not part of the off-chain protocol. If needed, clients are expected to
use <a href="#generic_messages">generic messages</a> to reach consensus around what the
next update shall be.</p>
<p>Even if a proper protocol is in place for reaching an agreement, there might
be a need for aborting an update explicitly. This is only possible while the
FSM is waiting for an authentication by this particular client. Once an update
is authenticated by a client, that client can no longer abort it.</p>
<p>The FSM produces two types of transactions according to how many
authentications are required for them:
* solo authenticated transactions:
  * <code>channel_close_solo_tx</code>
  * <code>channel_slash_tx</code>
  * <code>channel_settle_tx</code>
  * <code>channel_snapshot_tx</code>
* mutually authenticated transactions - all the rest</p>
<p>When a client is prompted to authenticate an update, it is expected to either
agree to it with an authentication or to abort it. Depending on the source of
the update, the other FSM might receive a message or not. If it was this
client that triggered the pending update - the other FSM is not aware of it
yet.  In this case no message is sent to the other FSM.  If the other party
started the update and has already authenticated it, our client can still
either authenticate or abort it. If aborted - the FSM will inform the other
party that the update was rejected, sending an abort conflict message.</p>
<p>If the update is aborted, the FSM returns to the last co-authenticated
state and enters an <code>open</code> state, waiting for a new update to be initiated.
Since there is no previous stable state before the channel initial
transaction, the <code>channel_create_tx</code> can not be aborted. It is the initiator
that produces it so if the responder had different expectations for it, it is
better to close the connection instead. Then it can be reopened with
a different set of opening arguments.</p>
<p>The request for aborting an update is the same, no matter whether or not the pending
update was triggered by the other party.</p>
<p>When there is a pending udpate, waiting for the client to approve, one can
also abort it using the same method one would use for providing the
authenticated transaction. The difference is that one provides an error code
instead.</p>
<pre><code class="javascript">{
   &quot;jsonrpc&quot;:&quot;2.0&quot;,
   &quot;method&quot;:&lt;signing method&gt;,
   &quot;params&quot;:{
      &quot;error&quot;:147
   }
}
</code></pre>

<p>The response the client receives in that case is:</p>
<pre><code class="javascript">{ 
   &quot;jsonrpc&quot;:&quot;2.0&quot;,
   &quot;method&quot;:&quot;channels.info&quot;,
   &quot;params&quot;:{ 
      &quot;channel_id&quot;:&quot;ch_95Ya...&quot;,
      &quot;data&quot;:{ 
         &quot;event&quot;:&quot;aborted_update&quot;
      }
   },
   &quot;version&quot;:1
}
</code></pre>

<p>If the client tries sending a abort message when it is not applicable, it
will receive an error response instead:</p>
<pre><code class="javascript">{
   &quot;channel_id&quot;:&quot;ch_95Ya...&quot;,
   &quot;error&quot;:{
      &quot;code&quot;:3,
      &quot;data&quot;:[
         {
            &quot;code&quot;:1018,
            &quot;message&quot;:&quot;Not allowed at current channel state&quot;
         }
      ],
      &quot;message&quot;:&quot;Rejected&quot;,
      &quot;request&quot;:{
         &quot;jsonrpc&quot;:&quot;2.0&quot;,
         &quot;method&quot;:&quot;channels.update&quot;,
            &quot;params&quot;:{
                &quot;error&quot;:147
            }
      }
   },
   &quot;id&quot;:null,
   &quot;jsonrpc&quot;:&quot;2.0&quot;,
   &quot;version&quot;:1
}
</code></pre>

<p>If the other party had triggered the aborted update, it is informed with
receiving the following message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.conflict&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;:&quot;ch_95Ya...&quot;,
    &quot;data&quot;: {
      &quot;channel_id&quot;:&quot;ch_95Ya...&quot;,
      &quot;error_code&quot;: 147,
      &quot;error_msg&quot;: &quot;user-defined&quot;,
      &quot;round&quot;: 5
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="generic-messages">Generic messages</h4>
<p>There is the functionality to send participants messages containing
information. In the scope of this - we are going to be calling those a <code>sender</code>
and a <code>receiver</code>. These roles can be taken by any of the participants, anytime.</p>
<p>The <code>sender</code> pushes a message with the following structure:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.message&quot;,
  &quot;params&quot;: {
    &quot;info&quot;: &quot;hejsan&quot;,
    &quot;to&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
  }
}
</code></pre>

<p>Then the <code>receiver</code> gets an event containing the info being sent and some
details:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.message&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;message&quot;: {
        &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
        &quot;from&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
        &quot;info&quot;: &quot;hejsan&quot;,
        &quot;to&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
      }
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="total-balance-update-events">Total balance update events</h4>
<p>After the channel has been opened it has a total balance of tokens committed to
it. This balance is persisted as part of the on-chain channel state. Upon
closing a channel on-chain, the closing balances of the participants are
checked against this balance. Under no circumstances can the sum of the closing balances
be greater than the total balance on-chain.</p>
<p>Participants are able to modify the total balance: the following two functionalities are available:</p>
<ul>
<li>deposit - when a participant wants to commit more tokens from his on-chain
  balance to the channel total balance</li>
<li>withdrawal - when a participant wants to transfer tokens out of the channel
  on-chain balance to one's personal account</li>
</ul>
<h3 id="deposit-events">Deposit events</h3>
<p>After the channel had been opened any of the participants can initiate a
deposit. The process closely resembles the <a href="#update">update</a>. The most notable
difference is the transaction has been mutually authenticated: it is <code>channel_deposit_tx</code> and
after the procedure is finished, it is posted on-chain.</p>
<p>Since both the initiator and responder can deposit tokens, in the scope of this description we
will call the participant that commits tokens to the channel a depositor and
the other party - acknowledger. Note that any public key outside of the channel participants
is considered invalid for the depositor role.</p>
<h4 id="deposit-transaction">Deposit transaction</h4>
<p>The <code>channel_deposit_tx</code> is a change to be applied on top of the latest channel state. It also is
posted on-chain and is included in a block. It has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel</td>
</tr>
<tr>
<td>from</td>
<td>string</td>
<td>depositor's public key</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>the amount committed to the channel</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>minimum block height to include the transaction</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>fee to be paid to the miner</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation</td>
</tr>
<tr>
<td>state_hash</td>
<td>string</td>
<td>the root of the internal channel state hash after the deposit</td>
</tr>
<tr>
<td>round</td>
<td>integer</td>
<td>the next channel round</td>
</tr>
<tr>
<td>nonce</td>
<td>integer</td>
<td>depositor's nonce</td>
</tr>
</tbody>
</table>
<h4 id="start-deposit">Start deposit</h4>
<p>Any of the participants can initiate a deposit. Only requirements are:
* Channel is already opened
* No off-chain update/deposit/withdrawal is currently being performed
* Channel is not being closed or in a solo closing state
* The deposit must be equal to or greater than zero, and cannot exceed the
  available balance on the depositor's account</p>
<h5 id="trigger-a-deposit">Trigger a deposit</h5>
<p>The depositor sends a WebSocket message containing the desired change</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.deposit&quot;,
  &quot;params&quot;: {
    &quot;amount&quot;: 2
  }
}
</code></pre>

<h5 id="depositor-authenticates-updated-state">Depositor authenticates updated state</h5>
<p>The depositor receives a message containing the updated channel state as a
<code>channel_deposit_tx</code> transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.deposit_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+HIzAaE...&quot;,
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 2,
          &quot;from&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
          &quot;op&quot;: &quot;OffChainDeposit&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The depositor is to decode the transaction, inspect its contents,
solo-authenticate it, encode it and then post it back via a WebSocket
message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.deposit_tx&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+LwLAf...&quot;
  }
}
</code></pre>

<h4 id="acknowledger-update_3">Acknowledger update</h4>
<p>The acknowledger receives an info message indicating an upcoming change:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;deposit_created&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Then the acknowledger receives a new message containing the deposit
solo-authenticated transaction for confirmation:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.deposit_ack&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+LwLAf...&quot;
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 2,
          &quot;from&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
          &quot;op&quot;: &quot;OffChainDeposit&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same transaction as the one that the depositor had
already authenticated. The acknowledger is to decode the transaction, inspect
its contents, authenticate it, encode it and then post it back via a WebSocket
message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.deposit_ack&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+LwLAfhCu...&quot;
  }
}
</code></pre>

<h4 id="finish-deposit">Finish deposit</h4>
<p>After both parties had authenticated the deposit transaction, the transaction is posted on-chain and
both parties receive it:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;deposit_signed&quot;,
      &quot;tx&quot;: &quot;tx_+LwLAfhCu...&quot;,
      &quot;type&quot;: &quot;channel_deposit_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>They are both to compute the transaction hash. Using it,
participants can track its progress on the chain: entering the mempool, block
inclusion and a number of confirmations.</p>
<p>After the <code>minimum_depth</code> block confirmations each participant is informed
for the deposit progress on-chain by one's own node:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;own_deposit_locked&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>An update from one's own node that the other party had confirmed that the block
height needed is reached:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;deposit_locked&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>With this the deposit sequence is complete and the channel can continue with
other updates. Note that the deposit transaction's <code>round</code> and <code>state_hash</code>
are the ones considered latest from the channel's perspective. For example the
next correct off-chain update/deposit/withdrawal shall have a deposit
transaction's <code>round</code> plus one.</p>
<h3 id="withdraw-events">Withdraw events</h3>
<p>After the channel had been opened any of the participants can initiate a
withdrawal. The process closely resembles the <a href="#update">update</a>. The most notable
difference is that the transaction has been mutually authenticated: it is <code>channel_withdraw_tx</code> and
after the procedure is finished - it is being posted on-chain.</p>
<p>Since both the initiator and responder can withdraw tokens, in the scope of this description we
will call the participant that commits tokens to the channel a withdrawer and
the other party - an acknowledger. Note that any public key outside of the channel participants
is considered invalid for the withdrawer role.</p>
<h4 id="withdraw-transaction">Withdraw transaction</h4>
<p>The <code>channel_withdraw_tx</code> is a change to be applied on top of the latest channel state. It also is
posted on-chain and is included in a block. It has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel</td>
</tr>
<tr>
<td>to</td>
<td>string</td>
<td>withdrawer's public key</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>the amount taken out from the channel</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>minimum block height to include the transaction</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>fee to be paid to the miner</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation</td>
</tr>
<tr>
<td>state_hash</td>
<td>string</td>
<td>the root of the internal channel state hash after the withdraw</td>
</tr>
<tr>
<td>round</td>
<td>integer</td>
<td>the next channel round</td>
</tr>
<tr>
<td>nonce</td>
<td>integer</td>
<td>withdrawer's nonce</td>
</tr>
</tbody>
</table>
<h4 id="start-withdraw">Start withdraw</h4>
<p>Any of the participants can initiate a withdrawal. The only requirements are:
* Channel is already opened
* No off-chain update/deposit/withdrawal is currently being performed
* Channel is not being closed or in a solo closing state
* The withdrawal amount must be equal to or greater than zero, and cannot
  exceed the available balance on the channel (minus the <code>channel_reserve</code>)</p>
<h5 id="trigger-a-withdrawal">Trigger a withdrawal</h5>
<p>The withdrawer sends a WebSocket message containing the desired change</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.withdraw&quot;,
  &quot;params&quot;: {
    &quot;amount&quot;: 2
  }
}
</code></pre>

<h5 id="withdrawer-authenticates-updated-state">Withdrawer authenticates updated state</h5>
<p>The withdrawer receives a message containing the updated channel state as a
<code>channel_withdraw_tx</code> transaction</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.withdraw_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+HI0AaE...&quot;,
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 2,
          &quot;op&quot;: &quot;OffChainWithdrawal&quot;,
          &quot;to&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The withdrawer is to decode the transaction, inspect its contents,
authenticate it, encode
it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.withdraw_tx&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+LwLAf...&quot;
  }
}
</code></pre>

<h4 id="acknowledger-update_4">Acknowledger update</h4>
<p>The acknowledger receives an info message indicating an upcoming change:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;withdraw_created&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Then the acknowledger receives a new message containing the already
solo-authenticated withdraw transaction for confirmation:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.withdraw_ack&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+LwLAf...&quot;
      &quot;updates&quot;: [
        {
          &quot;amount&quot;: 2,
          &quot;op&quot;: &quot;OffChainWithdrawal&quot;,
          &quot;to&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;
        }
      ]
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Note that this is the same transaction as the one that the withdrawer has
already authenticated. The acknowledger is to decode the transaction, inspect
its contents, authenticate it, encode it and then post it back via a WebSocket
message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.withdraw_ack&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+LwLAfhC...&quot;
  }
}
</code></pre>

<h4 id="finish-withdrawal">Finish withdrawal</h4>
<p>After both the parties had authenticated the withdraw transaction, the transaction is posted on-chain and
both parties receive it:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;withdraw_signed&quot;,
      &quot;tx&quot;: &quot;tx_+LwLAfhC...&quot;,
      &quot;type&quot;: &quot;channel_withdraw_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>They are both to compute the transaction hash. Using it,
participants can track its progress on the chain: entering the mempool, block
inclusion and a number of confirmations.</p>
<p>After the <code>minimum_depth</code> block confirmations each participant is informed
for the withdraw progress on-chain by one's own node:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;own_withdraw_locked&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>An update from one's own node that the other party had confirmed that the block
height needed is reached:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.info&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;event&quot;: &quot;withdraw_locked&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>With this the withdrawal sequence is complete and the channel can continue with
other updates. Note that the withdraw transaction's <code>round</code> and <code>state_hash</code>
are the ones considered latest from the channel's perspective. For example the
next correct off-chain update/deposit/withdrawal shall have a withdraw
transaction's <code>round</code> plus one.</p>
<h3 id="getting-state">Getting state</h3>
<p>At any moment in time any participant can ask one's own FSM for various views of
the latest channel state. This is to help wallet apps but they shall not trust
FSM and compute state locally.</p>
<h4 id="get-balances">Get balances</h4>
<p>In order to get the balances as those are part from the channel's state tree, a
participant sends a WebSocket message</p>
<pre><code class="javascript">{
  &quot;id&quot;: -576460752303423431,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.balances&quot;,
  &quot;params&quot;: {
    &quot;accounts&quot;: [
      &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
    ]
  }
}
</code></pre>

<p>The <code>accounts</code> section of the payload contains a list of addresses to fetch
balances of. Those can be either account balances or a contract ones, encoded
as an account addresses.</p>
<p>A response of this call looks like</p>
<pre><code class="javascript">{
  &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
  &quot;id&quot;: -576460752303423431,
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;result&quot;: [
    {
      &quot;account&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;balance&quot;: 69999999999969
    },
    {
      &quot;account&quot;: &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;,
      &quot;balance&quot;: 39999999999981
    }
  ],
  &quot;version&quot;: 1
}
</code></pre>

<p>If a certain account address had not being found in the state tree - it is simply
skipped in the response.</p>
<h4 id="get-proof-of-inclusion">Get proof of inclusion</h4>
<p>In order to build and use different services, one might need to provide a third party
a minimal view of the internal channel's state.</p>
<p>In order to fetch a proof of inclusion from the latest modified state tree,
a participant sends a WebSocket message</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.poi&quot;,
  &quot;params&quot;: {
    &quot;accounts&quot;: [
      &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;ak_nQpnNuBPQwibGpSJmjAah6r3ktAB7pG9JHuaGWHgLKxaKqEvC&quot;
    ],
    &quot;contracts&quot;: [
      &quot;ct_2Yy7TpPUs7SCm9jkCz7vz3nkb18zs78vcuVQGbgjRaWQNTWpm5&quot;
    ]
  }
}
</code></pre>

<p>The <code>accounts</code> section of the payload contains a list of addresses to include in the
proof of inclusion. Almost the same goes with the contract addesses listed in <code>contracts</code> section:
the only difference being that contract's accounts will be automatically be added
to proof of inclusion as well as their state.</p>
<p>A response of this call looks like</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.poi.reply&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;poi&quot;: &quot;pi_+QjLPAH5A...&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>If a certain address of an account or a contract is not found in the state tree -
the response is an error.</p>
<h4 id="dry-run-a-contract">Dry-run a contract</h4>
<p>In order to get the result of a potential contract call, one might need to
dry-run a contract call. It takes the exact same arguments as a call would (including
optional <code>meta</code> objects) and returns the <code>call</code> object.</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.dry_run.call_contract&quot;,
  &quot;params&quot;: {
    &quot;abi_version&quot;: 1,
    &quot;amount&quot;: 0,
    &quot;call_data&quot;: &quot;cb_AAAAAAA...&quot;,
    &quot;contract_id&quot;: &quot;ct_2A67iNjuNd2erJdzDMCzVeJkj82cS1krGGFbQeheBhFELktpo4&quot;
  }
}
</code></pre>

<p>The <code>payload</code> is an mirror image of the <a href="#trigger-a-contract-call-update">call contract
update</a>, the only difference being that the
dry-run does not impact the state and it does not need authentication. The call is
executed in the channel's state but it does not impact the state whatsoever.
It uses as an environment the latest channel's state and the current top of
the blockchain as seen by the node.</p>
<p>A response to this call looks like</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.dry_run.call_contract.reply&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;caller_id&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;caller_nonce&quot;: 11,
      &quot;contract_id&quot;: &quot;ct_2A67iNjuNd2erJdzDMCzVeJkj82cS1krGGFbQeheBhFELktpo4&quot;,
      &quot;gas_price&quot;: 1,
      &quot;gas_used&quot;: 220,
      &quot;height&quot;: 11,
      &quot;log&quot;: [],
      &quot;return_type&quot;: &quot;ok&quot;,
      &quot;return_value&quot;: &quot;cb_AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABX4y1tk&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h4 id="get-contract-calls">Get contract calls</h4>
<p>Each participant persists contract call results locally. It is not required of
both participants to share the same list of contract calls as this does not
impact consensus between them. Any participant can prune his local set of
calls in order to free some memory. In order to inspect the result value of a
contract call, a participant sends a WebSocket message</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.contract_call&quot;,
  &quot;params&quot;: {
    &quot;caller_id&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
    &quot;contract_id&quot;: &quot;ct_2A67iNjuNd2erJdzDMCzVeJkj82cS1krGGFbQeheBhFELktpo4&quot;,
    &quot;round&quot;: 10
  }
}
</code></pre>

<p>The combination of a <code>caller_id</code>, <code>contract_id</code> and a <code>round</code> of execution determines the
contract call. Providing an incorrect set of those results in an error response.</p>
<p>A non-error response of this call looks like this</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.get.contract_call.reply&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;caller_id&quot;: &quot;ak_2MGLPW2CHTDXJhqFJezqSwYSNwbZokSKkG7wSbGtVmeyjGfHtm&quot;,
      &quot;caller_nonce&quot;: 10,
      &quot;contract_id&quot;: &quot;ct_2A67iNjuNd2erJdzDMCzVeJkj82cS1krGGFbQeheBhFELktpo4&quot;,
      &quot;gas_price&quot;: 1,
      &quot;gas_used&quot;: 220,
      &quot;height&quot;: 10,
      &quot;log&quot;: [],
      &quot;return_type&quot;: &quot;ok&quot;,
      &quot;return_value&quot;: &quot;cb_AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABX4y1tk&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>It is worth mentioning that the gas is not consumed, because this is an off-chain contract call.
It would be consumed if it were a on-chain one. This could happen if a call with a
similar computation amount is to be forced on-chain.</p>
<h4 id="pruning-contract-calls">Pruning contract calls</h4>
<p>Contract calls are kept locally in order for the participant to be able to
look them up. They consume memory and in order for the participant to free it -
one can prune all messages. This cleans up all locally stored contract calls
and those will no longer be available for fetching and inspection.</p>
<p>In order to prune local calls, a participant sends the following WebSocket
message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.clean_contract_calls&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<p>Once calls are pruned, the same participant receives the following message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.calls_pruned.reply&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;action&quot;: &quot;calls_pruned&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<h3 id="solo-closing-sequence">Solo closing sequence</h3>
<p>At any moment in time after the channel had been opened any participant can
initiate a solo closing. The mutual closing takes just one block
inclusion for the effects to take place. The solo closing sequence requires a
couple of blocks and at least 2 transaction fees to be paid. This makes the
solo closing sequence both slower and more expensive. It is intended to be
used when the other party is trying to cheat or is not responding for a while.
This is called a dispute and it is taken to the chain to resolve it. Dispute
resolution has the following steps:</p>
<ol>
<li>single <code>channel_solo_close_tx</code> transaction</li>
<li>zero or a couple of <code>channel_slash_tx</code> transactions</li>
<li>single <code>channel_settle_tx</code> transaction</li>
</ol>
<p>The second step is not required and a <code>channel_solo_close</code> could be followed
either by zero, one or more <code>channel_slash</code> transactions, each subsequent one
presenting a newer state and overwriting the previous one. Those are settled by
a <code>channel_settle</code> transaction that finally closes the channel. Let's discuss
those in detail.</p>
<h4 id="payload-and-proof-of-inclusion">Payload and proof of inclusion</h4>
<p>The idea behind <code>channel_solo_close_tx</code> <code>channel_slash_tx</code> and
<code>channel_settle</code> is for parties to provide, on-chain, the latest channel
internal state so that the channel can be closed.
First comes the <code>channel_solo_close_tx</code> that provides some off-chain state.
Then a <code>channel_slash_tx</code> can be posted, but it is checked that it has a newer
state than the <code>channel_solo_close_tx</code> one. Then parties can post more
<code>channel_slash_tx</code> transactions, but those are always checked to be containing
a newer channel state than the last received on-chain. If one party tries to
cheat by posting some old state - the other party can present to the chain a
newer channel state and this overwrites the previous posted one. Thus the
comparison on channel states is important. This is done by comparing rounds.</p>
<p>Both <code>channel_solo_close_tx</code> and <code>channel_slash_tx</code> contain a <code>payload</code>
field. This is either a binary containing a <code>channel_offchain</code> transaction or an
empty binary.</p>
<p>If it is a <code>channel_offchain_tx</code> transaction, it must be mutually authenticated.
It also contains a <code>channel_id</code>, <code>round</code> and <code>state_hash</code>.
The <code>channel_id</code> in combination with the correct singatures verifies that this
off-chain transaction indeed is part of the channel off-chain state. The <code>round</code>
represents the height of the channel's state at the time when the transaction was
mutually authenticated. The higher the round, the newer the transaction is. This
<code>round</code> must be greater than the last on-chain one for that channel.
The <code>state_hash</code> is the internal channel state tree root hash at that <code>round</code>
height.</p>
<p>If the transaction's <code>payload</code> is empty - then the latest on-chain state for
this channel is used. Both <code>channel_deposit_tx</code> and <code>channel_withdraw_tx</code>
transactions contain a <code>round</code> and a <code>state_hash</code> and the latest received one
overwrites the previous one. If there had been none of those, then the
<code>channel_create</code> transaction is used: it has a <code>state_hash</code> and an implicit
<code>round = 1</code>.</p>
<p>Either by having a value in the <code>payload</code> or not having one, the
<code>channel_solo_close</code> and <code>channel_slash</code> provide a channel's <code>round</code> and a
<code>state_hash</code>. In order to determine the order of the channel's states received,
we compare the <code>rounds</code> and keep the state with the greatest <code>round</code>, considered
to be the <em>newest</em> and <em>latest</em> state. They also provide the <code>state_hash</code> that
the channel's state tree had at this <code>round</code>.</p>
<p>Both <code>channel_solo_close_tx</code> and <code>channel_slash_tx</code> contain a <code>poi</code> field.
This is the proof of inclusion for participants' balances in the channel state:
all the insignificant data in the channel's MPT (Merkle Patricia Tree) is replaced
by corresponding hashes.
The root hash of the PoI must be equal to the <code>state_hash</code> provided by the <code>payload</code>.
This guarantees that the PoI indeed is a proof of inclusion for tree at this height.</p>
<h4 id="solo-close-on-chain-transaction">Solo close on-chain transaction</h4>
<p>The <code>channel_close_solo_tx</code> transaction is the one that triggers the solo
closing sequence. After it is included on-chain channel enters a <em>closing</em> state
and any subsequent withdrawal or deposits are considered invalid. Preconditions
for the <code>channel_close_solo_tx</code> to be valid are:</p>
<ul>
<li>channel is opened on-chain</li>
<li>channel is not in a <em>closing</em> state but not yet closed - no
  <code>channel_close_solo_tx</code> has been included in a block yet</li>
</ul>
<p>Any participant in the channel can post a <code>channel_close_solo_tx</code> transaction.
In the scope of this description we will call the one that posts the transaction
<em>solo closer</em>. The transaction has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel to close</td>
</tr>
<tr>
<td>from</td>
<td>string</td>
<td>solo closer's public key</td>
</tr>
<tr>
<td>payload</td>
<td>binary</td>
<td>closing payload</td>
</tr>
<tr>
<td>poi</td>
<td>binary</td>
<td>closing proof of inclusion</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>maximum block height to include the transaction</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>fee to be paid to the miner</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation</td>
</tr>
<tr>
<td>nonce</td>
<td>integer</td>
<td>solo closer's nonce</td>
</tr>
</tbody>
</table>
<p><code>payload</code> and <code>poi</code> are validated as <a href="#payload-and-proof-of-inclusion">described above</a></p>
<h4 id="slash-on-chain-transaction">Slash on-chain transaction</h4>
<p>After the channel is already in a <em>closing</em> state, both participants can provide
a newer state via the <code>channel_slash_tx</code> transaction. Preconditions for
the <code>channel_slash_tx</code> to be valid are:</p>
<ul>
<li>channel is opened on-chain</li>
<li>channel is still in a <em>closing</em> state - no <code>channel_settle_tx</code> has been
  included in a block yet</li>
</ul>
<p>Any participant in the channel can post a <code>channel_slash_tx</code> transaction. In
the scope of this description we will call the one that posts the transaction
<em>slasher</em>.
The transaction has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel to slash</td>
</tr>
<tr>
<td>from</td>
<td>string</td>
<td>slasher's public key</td>
</tr>
<tr>
<td>payload</td>
<td>binary</td>
<td>slashing payload</td>
</tr>
<tr>
<td>poi</td>
<td>binary</td>
<td>slashing proof of inclusion</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>maximum block height to include the transaction</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>fee to be paid to the miner</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation</td>
</tr>
<tr>
<td>nonce</td>
<td>integer</td>
<td>slasher's nonce</td>
</tr>
</tbody>
</table>
<p><code>payload</code> and <code>poi</code> are validated as <a href="#payload-and-proof-of-inclusion">described above</a></p>
<h4 id="settle-on-chain-transaction">Settle on-chain transaction</h4>
<p>After the <code>channel_close_solo_tx</code> and all the <code>channel_slash_tx</code> transactions,
it is time to finally close the channel. One of the participants posts a
<code>channel_settle_tx</code> transaction that enforces closing of the channel. This
happens according to the latest channel state that was sent on-chain. The
<code>channel_settle_tx</code> just finalizes the channel closing with the last received
state, redistributes tokens to participants and closes the channel. No further
disputes are possible after that.</p>
<p>In order to give parties time to slash a closing channel and update its state
with a newer one, there is a timeframe only after which the <code>channel_settle_tx</code>
can be posted. This is measured in blocks mined on top of the last received
transaction for that channel (either <code>channel_close_solo_tx</code> or
<code>channel_slash_tx</code>). The amount itself is prenegotiated before opening the
channel and is part of the <code>channel_create_tx</code> transaction - it is the value of
<code>lock_period</code>. Under no condition can a <code>channel_settle_tx</code> be included in a
block before passing the <code>lock_period</code> amount of blocks on top of the last
<code>channel_close_solo_tx</code> or <code>channel_slash_tx</code> transaction. Every next included
<code>channel_slash_tx</code> restarts the timer. It is worth noting that since those
transactions must include a <code>payload</code> newer than the prevous on-chain one - this
timer can not be postponed indefinitely. Preconditions for the
<code>channel_settle_tx</code> to be valid are:</p>
<ul>
<li>channel is opened on-chain</li>
<li>channel is still in a <em>closing</em> state - no other <code>channel_settle_tx</code> has been
  included in a block yet</li>
<li>at least <code>lock_period</code> blocks has been mined on top of the last
  <code>channel_close_solo_tx</code> or <code>channel_slash_tx</code></li>
</ul>
<p>Any participant in the channel can post a <code>channel_settle_tx</code> transaction. In
the scope of this description we will call the one that posts the transaction
<em>settler</em>.
The transaction has the following structure:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>channel id</td>
<td>string</td>
<td>ID of the channel to settle</td>
</tr>
<tr>
<td>from</td>
<td>string</td>
<td>settler's public key</td>
</tr>
<tr>
<td>initiator_amount_final</td>
<td>integer</td>
<td>initiator final amount</td>
</tr>
<tr>
<td>responder_amount_final</td>
<td>integer</td>
<td>responder final amount</td>
</tr>
<tr>
<td>ttl</td>
<td>integer</td>
<td>maximum block height to include the transaction</td>
</tr>
<tr>
<td>fee</td>
<td>integer</td>
<td>fee to be paid to the miner</td>
</tr>
<tr>
<td>gas_price</td>
<td>integer</td>
<td>the gas_price to be used for the fee computation</td>
</tr>
<tr>
<td>nonce</td>
<td>integer</td>
<td>settler's nonce</td>
</tr>
</tbody>
</table>
<p>The amounts are the exact amounts stored in the channel object on-chain.</p>
<h4 id="connection-keep-alive">Connection keep alive</h4>
<p>WebSocket connection handlers are to identify abrupt network disconnects.
Thus the WebSocket protocol defines special control frames to be used: sending
<code>ping</code> and <code>pong</code>. Clients that are run in a browser have no access nor do
they have any control over those frames. They are to be handled by browsers
and this could introduce some undesired incompatibilities.</p>
<p>In order to provide best user experience, we've kept the functionality of the
node to respond with a <code>pong</code> control frame to every <code>ping</code> received as well
as enhanced the State Channel's WebSocket API with the option of sending data
frames that act like the corresponding control frames. Depending on the
environment to be run, the client can use either approach.</p>
<p>If no frames have been received for 1 minute, the node will consider the
connection to the client to be lost.</p>
<p>A data frame <code>ping</code> message has the following structure:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.system&quot;,
  &quot;params&quot;: {
    &quot;action&quot;: &quot;ping&quot;
  }
}
</code></pre>

<p>If the connection is still open, the node will respond to the same participant
with the following message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.system.pong&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_zVDx935M1AogqZrNmn8keST2jH8uvn5kmWwtDqefYXvgcCRAX&quot;,
    &quot;data&quot;: {
      &quot;action&quot;: &quot;system&quot;,
      &quot;tag&quot;: &quot;pong&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>Where <code>channel_id</code> has the correct value of the channel's ID.</p>
<h2 id="channel-snapshot">Channel snapshot</h2>
<p>Every once and a while a participant might feel the urge to post the latest
channel off-chain state on-chain. That would protect them from malicious
actions from the other party, namely unilaterally closing the channel with an
older state. This can be prevented by posting a <code>channel_snapshot_solo_tx</code>
transaction on-chain containing the latest co-authenticated off-chain state -
this guarantees that an older state can not make it on-chain.</p>
<p>It is worth mentioning that if the latest off-chain state is already present
on-chain, the snapshot transaction would not provide any new information
on-chain, so it would fail to be included in the blockchain.</p>
<h4 id="snapshotter-inittiates-a-snapshot-solo">Snapshotter inittiates a snapshot solo</h4>
<p>If the channel is in an <code>open</code> state, any participant can initiate a solo
snapshot transaction by:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.snapshot_solo&quot;,
  &quot;params&quot;: {}
}
</code></pre>

<h4 id="snapshotter-authenticates-the-snapshot-solo">Snapshotter authenticates the snapshot solo</h4>
<p>After the <code>channel_snapshot_solo_tx</code> has been requested, the FSM prompts the
client to sign it with:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.sign.snapshot_solo_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2eiGsAvtieLe2LUwRZLRVdYce9GyPESxJ9UMTBNyZ1gMvoJnnh&quot;,
    &quot;data&quot;: {
      &quot;signed_tx&quot;: &quot;tx_+QEuCwHAuQEo+QElOwGhBtlTLk1APdmHaziEHEcIBoE7hPShdgfNfwXzK6QenjIOoQHRNm8xdRGfaP8NRS1ZqdGmmsRo8FaC1wW2VWFid7ROELjU+NILAfiEuEAgCeNiiWzLM/cnnqBUv7vRXbaq1oaWD8Ef51YSkRYbPItrwgWidg6w7Q8Ood5kz83sYM26CgwKz4I/AuHusZgKuEDr+hWc0jwrJfeW9ZIojnua4h/tuWLQsr4j2Le5i3spTHVXjba1IClTiqeIZS/3NpnReUsDv1/POzEj1oBZRaEFuEj4RjkCoQbZUy5NQD3Zh2s4hBxHCAaBO4T0oXYHzX8F8yukHp4yDgWgFk9HuJ93FJGde2FyW3hXYthviTWdftxygmDVi9qw3+4AhhMG0SswAAH0oWnV&quot;,
      &quot;updates&quot;: []
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The snapshotter is to decode the transaction, inspect its contents,
authenticate it, encode it and then post it back via a WebSocket message:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.snapshot_solo_sign&quot;,
  &quot;params&quot;: {
    &quot;signed_tx&quot;: &quot;tx_+QFxCwH4QrhAV/hWnb8Sh/IknFVUSLYJSQu8v9+SIqilR/Hd/jqKGxCq2OOostDw/DtGNBeqkqeftz2OT4g9EjTR1fyWINwEDLkBKPkBJTsBoQbZUy5NQD3Zh2s4hBxHCAaBO4T0oXYHzX8F8yukHp4yDqEB0TZvMXURn2j/DUUtWanRpprEaPBWgtcFtlVhYne0ThC41PjSCwH4hLhAIAnjYolsyzP3J56gVL+70V22qtaGlg/BH+dWEpEWGzyLa8IFonYOsO0PDqHeZM/N7GDNugoMCs+CPwLh7rGYCrhA6/oVnNI8KyX3lvWSKI57muIf7bli0LK+I9i3uYt7KUx1V422tSApU4qniGUv9zaZ0XlLA79fzzsxI9aAWUWhBbhI+EY5AqEG2VMuTUA92YdrOIQcRwgGgTuE9KF2B81/BfMrpB6eMg4FoBZPR7ifdxSRnXthclt4V2LYb4k1nX7ccoJg1YvasN/uAIYTBtErMAABqvLutg==\&quot;
  }
}
</code></pre>

<p>The FSM is to check the transaction and its authentication and then post it
from snapshotters's behalf on-chain. Once it detects it being included
on-chain, it would report it:</p>
<pre><code class="javascript">{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;channels.on_chain_tx&quot;,
  &quot;params&quot;: {
    &quot;channel_id&quot;: &quot;ch_2eiGsAvtieLe2LUwRZLRVdYce9GyPESxJ9UMTBNyZ1gMvoJnnh&quot;,
    &quot;data&quot;: {
      &quot;info&quot;: &quot;channel_changed&quot;,
      &quot;tx&quot;: &quot;tx_+QFxCwH4QrhAV/hWnb8Sh/IknFVUSLYJSQu8v9+SIqilR/Hd/jqKGxCq2OOostDw/DtGNBeqkqeftz2OT4g9EjTR1fyWINwEDLkBKPkBJTsBoQbZUy5NQD3Zh2s4hBxHCAaBO4T0oXYHzX8F8yukHp4yDqEB0TZvMXURn2j/DUUtWanRpprEaPBWgtcFtlVhYne0ThC41PjSCwH4hLhAIAnjYolsyzP3J56gVL+70V22qtaGlg/BH+dWEpEWGzyLa8IFonYOsO0PDqHeZM/N7GDNugoMCs+CPwLh7rGYCrhA6/oVnNI8KyX3lvWSKI57muIf7bli0LK+I9i3uYt7KUx1V422tSApU4qniGUv9zaZ0XlLA79fzzsxI9aAWUWhBbhI+EY5AqEG2VMuTUA92YdrOIQcRwgGgTuE9KF2B81/BfMrpB6eMg4FoBZPR7ifdxSRnXthclt4V2LYb4k1nX7ccoJg1YvasN/uAIYTBtErMAABqvLutg==&quot;,
      &quot;type&quot;: &quot;channel_snapshot_solo_tx&quot;
    }
  },
  &quot;version&quot;: 1
}
</code></pre>

<p>The other participant's FSM will also notify its client that it had seen a new
transaction changing the channel on-chain being included in a microblock.</p>
<p>An interesting edge case would be one participant sending a snapshot with a
round greater than the last seen on-chain but yet not the latest one. This is
not cheating but if the other participant considers this to imply any risk to
them, one could send a <code>channel_snapshot_solo_tx</code> as well. The one with the higher
<code>round</code> will replace the other and all force-progressed states that had been
based on the older state.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../contract_api_usage/" title="Contract" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Contract
              </div>
            </div>
          </a>
        
        
          <a href="../mining_api_usage/" title="Mining" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Mining
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: [],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>